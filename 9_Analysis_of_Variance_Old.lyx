#LyX 2.1 created this file. For more info see http://www.lyx.org/
\lyxformat 474
\begin_document
\begin_header
\textclass book
\begin_preamble
\usepackage{a4wide}
\end_preamble
\options a4paper
\use_default_options false
\begin_modules
theorems-ams
knitr
\end_modules
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding iso8859-1
\fontencoding global
\font_roman default
\font_sans default
\font_typewriter default
\font_math auto
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry false
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 0
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 0
\use_package stackrel 0
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 0
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation skip
\defskip medskip
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Chapter
Analysis of Variance
\end_layout

\begin_layout Subsection*
Introduction
\end_layout

\begin_layout Standard
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<echo=FALSE>>=
\end_layout

\begin_layout Plain Layout

if(file.exists('Global_Knitr_Opts.R')){
\end_layout

\begin_layout Plain Layout

  source('Global_Knitr_Opts.R')
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

opts_chunk$set(fig.path   ='figure/Ch_9_ANOVA/') 
\end_layout

\begin_layout Plain Layout

opts_chunk$set(cache.path = 'cache/Ch_9_ANOVA/')
\end_layout

\begin_layout Plain Layout

opts_chunk$set(cache=TRUE)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset

We are now moving into a different realm of statistics.
 We have covered enough probability and the basic ideas of hypothesis tests
 and p-values to move onto the type of inference that you took this class
 to learn.
 The heart of science is comparing and evaluating which hypothesis is better
 supported by the data.
\end_layout

\begin_layout Standard
To evaluate a hypothesis, scientists will write a grant, hire grad students
 (or under-grads), collect the data, and then analyze the data using some
 sort of model that reflects the hypothesis under consideration.
 It could be as simple as 
\begin_inset Quotes eld
\end_inset

What is the relationship between iris species and petal width?
\begin_inset Quotes erd
\end_inset

 or as complex as 
\begin_inset Quotes eld
\end_inset

What is the temporal variation in growing season length in response to elevated
 CO
\begin_inset Formula $_{2}$
\end_inset

 in desert ecosystems?
\begin_inset Quotes erd
\end_inset

 
\end_layout

\begin_layout Standard
At the heart of the question is which predictors should be included in my
 model of the response variable.
 Given twenty different predictors, I want to pare them down to just the
 predictors that matter.
 I want to make my model as simple as possible, but still retain as much
 explanatory power as I can.
\end_layout

\begin_layout Standard
Our attention now turns to building models of our observed data in a fashion
 that allows us to ask if a predictor is useful in the model or if we can
 remove it.
 Our model building procedure will be consistent: 
\end_layout

\begin_layout Enumerate
Write two models, one that is perhaps overly simple and another that is
 a complication of the simple model.
\end_layout

\begin_layout Enumerate
Verify that the assumptions that are made in both models are satisfied.
 
\end_layout

\begin_layout Enumerate
Evaluate if the complex model explains significantly more of the variability
 in the data than the simple model.
\end_layout

\begin_layout Standard
Our goal here isn't to find 
\begin_inset Quotes eld
\end_inset

the right model
\begin_inset Quotes erd
\end_inset

 because no model is right.
 Instead our goal is to find a model that is 
\emph on
useful
\emph default
 and helps me to understand the science.
\end_layout

\begin_layout Standard
We will start by developing a test that helps me evaluate if a model that
 has a categorical predictor variable for a continuous response should have
 a mean value for each group or just one overall mean.
\end_layout

\begin_layout Section
Model
\end_layout

\begin_layout Standard
The two-sample t-test provided a convenient way to compare the means from
 two different populations and test if they were equal.
 We wish to generalize this test to more than two different populations.
\begin_inset Foot
status open

\begin_layout Plain Layout
Later when we have more tools in our statistical tool box, it is useful
 to notice that ANOVA uses a categorical variable (which group) to predict
 a continuous response.
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
Suppose that my data can be written as 
\begin_inset Formula 
\[
Y_{ij}=\mu_{i}+\epsilon_{ij}\;\;\;\;\;\textrm{where}\;\;\epsilon_{ij}\stackrel{iid}{\sim}N\left(0,\,\sigma\right)
\]

\end_inset

and 
\begin_inset Formula $\mu_{i}$
\end_inset

 is the mean of group 
\begin_inset Formula $i$
\end_inset

 and 
\begin_inset Formula $\epsilon_{ij}$
\end_inset

 are the deviations from the group means.
 Let the first subscript denote which group the observation is from 
\begin_inset Formula $i\in\{1,\dots k\}$
\end_inset

 and the second subscript is the observation number within that sample.
 Each group has its own mean 
\begin_inset Formula $\mu_{i}$
\end_inset

 and we might allow the number of observations in each group 
\begin_inset Formula $n_{i}$
\end_inset

 to be of different across the populations.
 
\end_layout

\begin_layout Standard
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout

\emph on
Assumptions:
\end_layout

\begin_layout Enumerate

\emph on
The error terms come from a normal distribution
\end_layout

\begin_layout Enumerate

\emph on
The variance of each group is the same
\end_layout

\begin_layout Enumerate

\emph on
The observations are independent
\end_layout

\begin_layout Enumerate

\emph on
The observations are representative of the population of interest
\end_layout

\end_inset

In general I want to test the hypotheses
\begin_inset Formula 
\begin{eqnarray*}
H_{0}: &  & \mu_{1}=\mu_{2}=\dots=\mu_{k}\\
H_{a}: &  & \textrm{at least on mean is different than the others}
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Example
Suppose that we have three hybrids of a particular plant and we measure
 the leaf area for each hybrid.
 
\end_layout

\begin_layout Standard
In the following graph, there does not appear to be a difference between
 the hybrid means:
\begin_inset Newline newline
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<echo=FALSE, fig.height=3, fig.width=6, message=FALSE>>=
\end_layout

\begin_layout Plain Layout

set.seed(34564)
\end_layout

\begin_layout Plain Layout

library(ggplot2)
\end_layout

\begin_layout Plain Layout

mu <- c(3.9,4,4.1) 
\end_layout

\begin_layout Plain Layout

sigma <- .5 
\end_layout

\begin_layout Plain Layout

data <- NULL 
\end_layout

\begin_layout Plain Layout

for(i in 1:length(mu)){   
\end_layout

\begin_layout Plain Layout

	data <- rbind(data, data.frame(Hybrid=i, LAI=rnorm(5, mean=mu[i], sd=sigma)))
\end_layout

\begin_layout Plain Layout

} 
\end_layout

\begin_layout Plain Layout

data$Hybrid <- factor(data$Hybrid) 
\end_layout

\begin_layout Plain Layout

p <- ggplot(data, aes(x=factor(Hybrid), y=LAI, col=Hybrid)) + 
\end_layout

\begin_layout Plain Layout

	geom_point(size=5) + 
\end_layout

\begin_layout Plain Layout

	labs(x='Hybrid', y='Leaf Area Index')
\end_layout

\begin_layout Plain Layout

print(p)
\end_layout

\begin_layout Plain Layout

data2 <- data
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Newline newline
\end_inset

However, in this case, it looks like there is a difference in the means
 of each hybrid:
\begin_inset Newline newline
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<echo=FALSE, fig.height=3, fig.width=6, message=FALSE>>=
\end_layout

\begin_layout Plain Layout

library(ggplot2)
\end_layout

\begin_layout Plain Layout

mu <- c(3,4,5) 
\end_layout

\begin_layout Plain Layout

sigma <- .2 
\end_layout

\begin_layout Plain Layout

data <- NULL 
\end_layout

\begin_layout Plain Layout

for(i in 1:length(mu)){   
\end_layout

\begin_layout Plain Layout

	data <- rbind(data, data.frame(Hybrid=i, LAI=rnorm(5, mean=mu[i], sd=sigma)))
\end_layout

\begin_layout Plain Layout

} 
\end_layout

\begin_layout Plain Layout

data$Hybrid <- factor(data$Hybrid) 
\end_layout

\begin_layout Plain Layout

p <- ggplot(data, aes(x=factor(Hybrid), y=LAI, col=Hybrid)) + 
\end_layout

\begin_layout Plain Layout

	geom_point(size=5) + 
\end_layout

\begin_layout Plain Layout

	labs(x='Hybrid', y='Leaf Area Index') 
\end_layout

\begin_layout Plain Layout

print(p)
\end_layout

\begin_layout Plain Layout

data1 <- data
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Newline newline
\end_inset

What is the difference between these two?
\end_layout

\begin_layout Enumerate
If the variance 
\emph on
between
\emph default
 hybrids is small compared the variance 
\emph on
within
\emph default
 a hybrid variance is huge compared, then I would fail to reject the null
 hypothesis of equal means (this would be the first case).
 In this case, the additional model complexity doesn't result in more accurate
 model, so Occam's Razor would lead us to prefer the simpler model where
 each group has the same mean.
\end_layout

\begin_layout Enumerate
If there is a large variance 
\emph on
between
\emph default
 hybrids compared to the variance 
\emph on
within
\emph default
 a hybrid then I'd conclude there is a difference (this would be the first
 case).
 In this case, I prefer the more complicated model with each group having
 separate means.
\end_layout

\begin_layout Section
Theory
\end_layout

\begin_layout Standard
Notation: 
\end_layout

\begin_layout Enumerate
\begin_inset Formula $n=n_{1}+n_{2}+\dots+n_{k}$
\end_inset

 as the total number of observations 
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\bar{y}_{i\cdot}=\frac{1}{n_{i}}\sum_{j=1}^{n_{i}}y_{ij}$
\end_inset

 as the sample mean from the 
\begin_inset Formula $i$
\end_inset

th group 
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\bar{y}_{\cdot\cdot}$
\end_inset

 be the mean of all the observations.
\end_layout

\begin_layout Standard
Regardless of if the null hypothesis is true, the following is an estimate
 of 
\begin_inset Formula $\sigma^{2}$
\end_inset

.
 We could use a pooled variance estimate similar to the estimator in the
 pooled two-sample t-test.
 We will denote this first estimator as the 
\emph on
within-group 
\emph default
estimate because the sums in the numerator are all measuring the variability
 within a group.
\begin_inset Formula 
\begin{eqnarray*}
s_{W}^{2} & = & \frac{\sum_{i=1}^{k}\sum_{j=1}^{n_{k}}\left(y_{ij}-\bar{y}_{i\cdot}\right)^{2}}{n-k}\\
\\
 & = & \frac{\sum_{j=1}^{n_{1}}\left(y_{1j}-\bar{y}_{1\cdot}\right)^{2}+\sum_{j=1}^{n_{2}}\left(y_{2j}-\bar{y}_{2\cdot}\right)^{2}+\dots+\sum_{j=1}^{n_{k}}\left(y_{kj}-\bar{y}_{k\cdot}\right)^{2}}{\left(n_{1}-1\right)+\left(n_{2}-1\right)+\dots+\left(n_{k}-1\right)}\\
\\
 & = & \frac{\left(n_{1}-1\right)s_{1}^{2}+\left(n_{2}-1\right)s_{2}^{2}+\dots+\left(n_{k}-1\right)s_{k}^{2}}{n-k}
\end{eqnarray*}

\end_inset

If the null hypothesis is true and 
\begin_inset Formula $\mu_{1}=\dots=\mu_{k}$
\end_inset

, then a second way that I could estimate the 
\begin_inset Formula $\sigma^{2}$
\end_inset

 is using the sample means.
 If 
\begin_inset Formula $H_{0}$
\end_inset

 is true then each sample mean has sampling distribution 
\begin_inset Formula $\bar{Y}_{i\cdot}\sim N\left(\mu,\frac{\sigma^{2}}{n_{i}}\right)$
\end_inset

.
 In the simple case where 
\begin_inset Formula $n_{1}=n_{2}=\dots=n_{k}$
\end_inset

 then the sample variance of the 
\begin_inset Formula $k$
\end_inset

 sample means 
\begin_inset Formula $\bar{y}_{1},\bar{y}_{2},\dots,\bar{y}_{k}$
\end_inset

 has expectation 
\begin_inset Formula $\sigma^{2}/n_{i}$
\end_inset

 and could be used to estimate 
\begin_inset Formula $\sigma^{2}$
\end_inset

.
 In the case of unequal sample sizes, the formula will be slightly different.
 
\begin_inset Formula 
\[
s_{B}^{2}=\frac{1}{k-1}\sum_{i=1}^{k}n_{i}\left(\bar{y}_{i\cdot}-\bar{y}_{\cdot\cdot}\right)^{2}
\]

\end_inset

Under the null hypothesis, these two estimates are both estimating 
\begin_inset Formula $\sigma^{2}$
\end_inset

 and should be similar and the ratio 
\begin_inset Formula $s_{B}^{2}/s_{W}^{2}$
\end_inset

 follows an F-distribution with numerator degrees of freedom 
\begin_inset Formula $k-1$
\end_inset

 and denominator degrees of freedom 
\begin_inset Formula $n-k$
\end_inset

 degrees of freedom.
 We define our test statistic as 
\begin_inset Formula 
\[
f=\frac{s_{B}^{2}}{s_{W}^{2}}
\]

\end_inset


\end_layout

\begin_layout Standard
In the case that the null hypothesis is false (non-equal means 
\begin_inset Formula $\mu_{1},\mu_{2},\dots,\mu_{k}$
\end_inset

), 
\begin_inset Formula $s_{B}^{2}$
\end_inset

 should be much larger than 
\begin_inset Formula $s_{W}^{2}$
\end_inset

 and our test statistic 
\begin_inset Formula $f$
\end_inset

 will be very large and so we will reject the null hypothesis if 
\begin_inset Formula $f$
\end_inset

 is greater than the 
\begin_inset Formula $1-\alpha$
\end_inset

 quantile from the F-distribution with 
\begin_inset Formula $k-1$
\end_inset

 and 
\begin_inset Formula $n_{t}-k$
\end_inset

 degrees of freedom.
 If 
\begin_inset Formula $s_{B}^{2}$
\end_inset

 is small, then the difference between the group means and the overall means
 is small and we shouldn't reject the null hypothesis.
 So this F-test will always be a one sided test, rejecting only if 
\begin_inset Formula $f$
\end_inset

 is large.
\begin_inset Formula 
\[
p-value=P\left(F_{k-1,\,n_{t}-k}>f\right)
\]

\end_inset


\end_layout

\begin_layout Subsection
Anova Table
\end_layout

\begin_layout Standard
There are several sources of variability that we are dealing with.
 
\end_layout

\begin_layout Standard

\series bold
SSW
\series default
: Sum of Squares Within - This is the variability within sample groups.
 It has an associated 
\begin_inset Formula $df_{W}=n-k$
\end_inset


\begin_inset Formula 
\[
SSW=\sum_{i=1}^{k}\sum_{j=1}^{n_{i}}\left(y_{ij}-\bar{y}_{i\cdot}\right)^{2}
\]

\end_inset


\end_layout

\begin_layout Standard

\series bold
SSB
\series default
: Sum of Squares Between - This is the variability between sample groups.
 It has an associated 
\begin_inset Formula $df_{B}=k-1$
\end_inset


\begin_inset Formula 
\[
SSB=\sum_{i=1}^{k}n_{i}\left(\bar{y}_{i\cdot}-\bar{y}_{\cdot\cdot}\right)^{2}
\]

\end_inset


\end_layout

\begin_layout Standard

\series bold
SST
\series default
: Sum of Squares Total - This is the total variability in the data set.
 It has an associated 
\begin_inset Formula $df=n-1$
\end_inset

 because under the null hypothesis there is only one mean 
\begin_inset Formula $\mu$
\end_inset

.
 
\begin_inset Formula 
\[
SST=\sum_{i=1}^{k}\sum_{j=1}^{n_{j}}\left(y_{ij}-\bar{y}_{\cdot\cdot}\right)^{2}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Flex Chunk
status open

\begin_layout Plain Layout

\begin_inset Argument 1
status open

\begin_layout Plain Layout
echo=FALSE, fig.height=4, fig.width=8
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

library(plyr)
\end_layout

\begin_layout Plain Layout

par(mfrow=c(1,3))
\end_layout

\begin_layout Plain Layout

mu <- c(3,4,6)  
\end_layout

\begin_layout Plain Layout

k <- length(mu) 
\end_layout

\begin_layout Plain Layout

sigma <- .2  
\end_layout

\begin_layout Plain Layout

n <- 5 
\end_layout

\begin_layout Plain Layout

jitter <- seq(-n,n,length=n)/(3*n) 
\end_layout

\begin_layout Plain Layout

data <- NULL  
\end_layout

\begin_layout Plain Layout

plot(x=c(0.5, k+.5), y=c(min(mu)-3*sigma, max(mu)+3*sigma),       
\end_layout

\begin_layout Plain Layout

	type='n', axes=FALSE, ylab='LAI', xlab='Group',      
\end_layout

\begin_layout Plain Layout

	main='Sum of Squares - Within Groups') 
\end_layout

\begin_layout Plain Layout

axis(1, at=1:3); axis(2); box() 
\end_layout

\begin_layout Plain Layout

for(i in 1:k){      
\end_layout

\begin_layout Plain Layout

	temp <- data.frame(Species=i, LAI=rnorm(5, mean=mu[i], sd=sigma))
\end_layout

\begin_layout Plain Layout

	points(temp$Species+jitter, temp$LAI, col=i)   
\end_layout

\begin_layout Plain Layout

	data <- rbind(data, temp) 
\end_layout

\begin_layout Plain Layout

}  
\end_layout

\begin_layout Plain Layout

data.means <- ddply(data, ~Species, summarize, Grp.Mean=mean(LAI)) 
\end_layout

\begin_layout Plain Layout

for(i in 1:k){   
\end_layout

\begin_layout Plain Layout

	lines(c(i-.5,i+.5), rep(data.means[i,'Grp.Mean'],2), col=i) 
\end_layout

\begin_layout Plain Layout

} 
\end_layout

\begin_layout Plain Layout

for(i in 1:k){   
\end_layout

\begin_layout Plain Layout

	for(j in 1:n){     
\end_layout

\begin_layout Plain Layout

		index <- (i-1)*n+j     
\end_layout

\begin_layout Plain Layout

		lines(rep(data[index,'Species']+jitter[j],2),
\end_layout

\begin_layout Plain Layout

           		c(data.means[i,'Grp.Mean'], data[index, 'LAI']),           
\end_layout

\begin_layout Plain Layout

			col=i)   
\end_layout

\begin_layout Plain Layout

	} 
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

plot(x=c(0.5, k+.5), y=c(min(mu)-3*sigma, max(mu)+3*sigma),
\end_layout

\begin_layout Plain Layout

    type='n', axes=FALSE, ylab='LAI', xlab='Group',      	
\end_layout

\begin_layout Plain Layout

	main='Sum of Squares - Between Groups') 
\end_layout

\begin_layout Plain Layout

axis(1, at=1:3); axis(2); box() 
\end_layout

\begin_layout Plain Layout

total.mean <- mean(data$LAI) 
\end_layout

\begin_layout Plain Layout

abline(h=total.mean, lwd=2) 
\end_layout

\begin_layout Plain Layout

for(i in 1:k){   
\end_layout

\begin_layout Plain Layout

	lines(c(i-.5,i+.5), rep(data.means[i,'Grp.Mean'],2), col=i) 
\end_layout

\begin_layout Plain Layout

} 
\end_layout

\begin_layout Plain Layout

for(i in 1:k){   
\end_layout

\begin_layout Plain Layout

	for(j in 1:n){     
\end_layout

\begin_layout Plain Layout

		index <- (i-1)*n+j     
\end_layout

\begin_layout Plain Layout

		lines(rep(data[index,'Species']+jitter[j],2),
\end_layout

\begin_layout Plain Layout

           		c(data.means[i,'Grp.Mean'], total.mean),           
\end_layout

\begin_layout Plain Layout

		col=i)   
\end_layout

\begin_layout Plain Layout

	} 
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

plot(x=c(0.5, k+.5), y=c(min(mu)-3*sigma, max(mu)+3*sigma),       
\end_layout

\begin_layout Plain Layout

	type='n', axes=FALSE, ylab='LAI', xlab='Group',      
\end_layout

\begin_layout Plain Layout

	main='Sum of Squares - Total') 
\end_layout

\begin_layout Plain Layout

axis(1, at=1:3); axis(2); box() 
\end_layout

\begin_layout Plain Layout

for(i in 1:k){   
\end_layout

\begin_layout Plain Layout

	index <- which(data$Species == i)   
\end_layout

\begin_layout Plain Layout

	points(data$Species[index]+jitter, data$LAI[index], col=i) 
\end_layout

\begin_layout Plain Layout

}  
\end_layout

\begin_layout Plain Layout

abline(h=total.mean, lwd=2) 
\end_layout

\begin_layout Plain Layout

for(i in 1:k){   
\end_layout

\begin_layout Plain Layout

	for(j in 1:n){     
\end_layout

\begin_layout Plain Layout

		index <- (i-1)*n+j     
\end_layout

\begin_layout Plain Layout

		lines(rep(data[index,'Species']+jitter[j],2),            
\end_layout

\begin_layout Plain Layout

			c(total.mean, data[index, 'LAI']),           
\end_layout

\begin_layout Plain Layout

			col=i)   
\end_layout

\begin_layout Plain Layout

	} 
\end_layout

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
An anova table is usually set up the in the following way (although the
 total row is sometimes removed):
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="6">
<features rotate="0" tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Source
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
df
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Sum of Squares
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mean Squares
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
F-stat
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
P-value
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Between Samples
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $k-1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $SSB$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $s_{B}^{2}=SSB/\left(k-1\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $f=s_{B}^{2}/s_{W}^{2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $P\left(F_{k-1,n-k}>f\right)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Within Samples
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $n-k$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $SSW$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $s_{W}^{2}=SSW/\left(n_{t}-k\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Total
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $n-1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $SST$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard
It can be shown that 
\begin_inset Formula 
\[
SST=SSB+SSW
\]

\end_inset

and we can think about what these sums actually mean by returning to our
 idea about simple vs complex models.
\end_layout

\begin_layout Subsection
ANOVA using Simple vs Complex models.
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
Upon the second reading of these notes, the student is likely asking why
 we even bothered introducing the ANOVA table using SST, SSW, SSB.
 The answer is that these notations are common in the ANOVA literature and
 that we can't justify using an F-test without variance estimates.
 Both interpretations are valid, but the Simple/Complex models are a better
 paradigm as we move forward.
 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The problem under consideration boils down to how complicated of a model
 should we fit.
 
\end_layout

\begin_layout Subsubsection*
Simple
\end_layout

\begin_layout Standard
The simple model is 
\begin_inset Formula 
\[
Y_{ij}=\mu+\epsilon_{ij}\;\;\;\textrm{where}\;\epsilon_{ij}\stackrel{iid}{\sim}N\left(0,\sigma^{2}\right)
\]

\end_inset

has each observation having the same expectation 
\begin_inset Formula $\mu$
\end_inset

.
 Thus we use the overall mean of the data 
\begin_inset Formula $\bar{y}_{\cdot\cdot}$
\end_inset

 as the estimate of 
\begin_inset Formula $\mu$
\end_inset

 and therefore our error terms are
\begin_inset Formula 
\[
e_{ij}=y_{ij}-\bar{y}_{\cdot\cdot}
\]

\end_inset

The sum of squared error associated with the simple model is thus
\begin_inset Formula 
\begin{eqnarray*}
SSE_{simple} & = & \sum_{i=1}^{k}\sum_{j=1}^{n_{i}}e_{ij}^{2}\\
\\
 & = & \sum_{i=1}^{k}\sum_{j=1}^{n_{i}}\left(y_{ij}-\bar{y}_{\cdot\cdot}\right)^{2}\\
\\
 & = & SST
\end{eqnarray*}

\end_inset

 
\end_layout

\begin_layout Subsubsection*
Complex
\end_layout

\begin_layout Standard
The more complicated model 
\begin_inset Formula 
\[
Y_{ij}=\mu_{i}+\epsilon_{ij}\;\;\;\textrm{where}\;\epsilon_{ij}\stackrel{iid}{\sim}N\left(0,\sigma^{2}\right)
\]

\end_inset

has each observation having the expectation of it's group mean 
\begin_inset Formula $\mu_{i}$
\end_inset

.
 We'll use the group means 
\begin_inset Formula $\bar{y}_{i\cdot}$
\end_inset

 as estimates for 
\begin_inset Formula $\mu_{i}$
\end_inset

 and thus the error terms are 
\begin_inset Formula 
\[
e_{ij}=y_{ij}-\bar{y}_{i\cdot}
\]

\end_inset

and the sum of squared error associated with the complex model is thus 
\begin_inset Formula 
\begin{eqnarray*}
SSE_{complex} & = & \sum_{i=1}^{k}\sum_{j=1}^{n_{i}}e_{ij}^{2}\\
 & = & \sum_{i=1}^{k}\sum_{j=1}^{n_{i}}\left(y_{ij}-\bar{y}_{i\cdot}\right)^{2}\\
 & = & SSW
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Subsubsection*
Difference
\end_layout

\begin_layout Standard
The difference between the simple and complex sums of squared error is denoted
 
\begin_inset Formula $SSE_{diff}$
\end_inset

 and we see 
\begin_inset Formula 
\begin{eqnarray*}
SSE_{diff} & = & SSE_{simple}-SSE_{complex}\\
 & = & SST-SSW\\
 & = & SSB
\end{eqnarray*}

\end_inset

Note that 
\begin_inset Formula $SSE_{diff}$
\end_inset

 can be interpreted as the amount of variability that is explained by the
 more complicated model vs the simple.
 If this 
\begin_inset Formula $SSE_{diff}$
\end_inset

 is large, then we should use the complex model.
 Our only question becomes 
\begin_inset Quotes eld
\end_inset

How large is large?
\begin_inset Quotes erd
\end_inset

 
\end_layout

\begin_layout Standard
First we must account for the number of additional parameters we have added.
 If we added five parameters, I should expect to account for more variability
 that if I added one parameter, so first we will divide 
\begin_inset Formula $SSE_{diff}$
\end_inset

 by the number of added parameters to get 
\begin_inset Formula $MSE_{diff}$
\end_inset

 which is the amount of variability explained by each additional parameter.
 If that amount is large compared to the leftover from the complex model,
 then we should use the complex model.
 
\end_layout

\begin_layout Standard
These calculations are preformed in the ANOVA table, and the following table
 is identical to the previous ANOVA table, and we have only changed the
 names given to the various quantities.
\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="6">
<features rotate="0" tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Source
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
df
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Sum of Squares
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mean Squares
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
F-stat
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
P-value
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Difference
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $k-1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $SSE_{diff}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $MSE_{diff}=\frac{SSE_{diff}}{k-1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $f=\frac{MSE_{diff}}{MSE_{complex}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $P\left(F_{k-1,n-k}>f\right)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Complex
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $n-k$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $SSE{}_{complex}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $MSE_{complex}=\frac{SSE_{complex}}{n-k}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Simple
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $n-1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $SSE_{simple}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Subsection
Parameter Estimates and Confidence Intervals
\end_layout

\begin_layout Standard
As usual, the sample mean 
\begin_inset Formula $\bar{y}_{i\cdot}$
\end_inset

 is a good estimator for the mean of group 
\begin_inset Formula $\mu_{i}$
\end_inset

.
 
\end_layout

\begin_layout Standard
But what about 
\begin_inset Formula $\sigma^{2}$
\end_inset

? If we conclude that we should use the complex model, and since one of
 our assumptions is that each group has equal variance, then I should use
 all of the residual terms 
\begin_inset Formula $e_{ij}=y_{ij}-\bar{y}_{i\cdot}$
\end_inset

 in my estimation of 
\begin_inset Formula $\sigma$
\end_inset

.
 In this case we will use 
\begin_inset Formula 
\[
\hat{\sigma}^{2}=s_{W}^{2}=MSE_{complex}=\frac{1}{n-k}\sum_{i=1}^{k}\sum_{j=1}^{n_{i}}\left(y_{ij}-\bar{y}_{i\cdot}\right)^{2}
\]

\end_inset

as the estimate of 
\begin_inset Formula $\sigma^{2}$
\end_inset

.
 Notice that this is analogous to the pooled estimate of the variance in
 a two-sample t-test with the assumption of equal variance.
\end_layout

\begin_layout Standard
Therefore an appropriate confidence interval for 
\begin_inset Formula $\mu_{i}$
\end_inset

 is 
\begin_inset Formula 
\[
\bar{y}_{i\cdot}\pm t_{\,n-k}^{1-\alpha/2}\left(\frac{\hat{\sigma}}{\sqrt{n_{i}}}\right)
\]

\end_inset


\end_layout

\begin_layout Section
Anova in R
\end_layout

\begin_layout Standard
First we must define a data frame with the appropriate columns.
 We start with two vectors, one of which has the leaf area data and the
 other vector denotes the species.
 Our response variable must be a continuous random variable and the explanatory
 is a discrete variable.
 In R discrete variables are called 
\family typewriter
factors
\family default
 and can you can change a numerical variable to be a factor using the function
 
\family typewriter
factor()
\family default
.
\end_layout

\begin_layout Standard
The analysis of variance method is an example of a linear model which can
 be fit in a variety of ways.
 We can use either 
\family typewriter
lm()
\family default
 or 
\family typewriter
aov()
\family default
 to fit this model, and the following we will concentrate on using 
\family typewriter
aov()
\family default
.
 The first argument to this function is a formula that describes the relationshi
p between the explanatory variables and the response variable.
 In this case it is extremely simple, that 
\family typewriter
LAI
\family default
 is a function of the categorical variable 
\family typewriter
Species
\family default
.
 
\end_layout

\begin_layout Standard
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

data <- data.frame(LAI = c(2.88, 2.87, 3.23, 3.24, 3.33, 
\end_layout

\begin_layout Plain Layout

                           3.83, 3.86, 4.03, 3.87, 4.16,
\end_layout

\begin_layout Plain Layout

                           4.79, 5.03, 4.99, 4.79, 5.05),
\end_layout

\begin_layout Plain Layout

                   Species = factor( rep(1:3, each=5) ) )
\end_layout

\begin_layout Plain Layout

str(data)
\end_layout

\begin_layout Plain Layout

model <- aov(LAI ~ Species, data=data)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The 
\family typewriter
aov()
\family default
 command is the command that does all the calculations necessary to fit
 an ANOVA model.
 This command returns a list object that is useful for subsequent analysis
 and it is up to the use to know what subsequent functions to call that
 answer questions of interest.
\end_layout

\begin_layout Standard
In the call to 
\family typewriter
aov()
\family default
 we created a formula.
 Formulas in R always are of the form 
\family typewriter
Y ~ X
\family default
 where 
\family typewriter
Y
\family default
 is the dependent variable and the 
\family typewriter
X
\family default
 variables are the independent variables.
 In the formula we passed to 
\family typewriter
aov()
\family default
, we used a 
\family typewriter
LAI ~ Species
\family default
.
 
\end_layout

\begin_layout Standard
Before we examine the anova table and make any conclusion, we should double
 check that the anova assumptions have been satisfied.
 To check the normality assumption, we will look at the qqplot of the residuals
 
\begin_inset Formula $e_{ij}=y_{ij}-\bar{y}_{i\cdot}$
\end_inset

.
 These residuals are easily accessed in R using the 
\family typewriter
resid
\family default
 function on the object 
\family typewriter
model
\family default
.
 To check the variance assumption, we will examine the boxplot of the data
\end_layout

\begin_layout Standard
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<fig.height=4>>=
\end_layout

\begin_layout Plain Layout

par(mfrow=c(1,2)) # side-by-side plots...
\end_layout

\begin_layout Plain Layout

qqnorm( resid(model) )
\end_layout

\begin_layout Plain Layout

qqline( resid(model) )
\end_layout

\begin_layout Plain Layout

boxplot(LAI~Species, data=data)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The qqplot doesn't look too bad, with only two observations far from the
 normality line.
 The equal variance assumption seems acceptable as well.
 To get the Analysis of Variance table, we'll extract it from the 
\family typewriter
model
\family default
 object using the function 
\family typewriter
anova()
\family default
.
\end_layout

\begin_layout Standard
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

model <- aov(LAI ~ Species, data=data)
\end_layout

\begin_layout Plain Layout

anova(model)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Notice that R does not give you the third line in the ANOVA table.
 This was a deliberate choice by the Core Development Team of R, but one
 that is somewhat annoying
\begin_inset Foot
status open

\begin_layout Plain Layout
The package 
\family typewriter
\size normal
NCStats
\family default
 modifies the print command for an 
\family typewriter
aov
\family default
 object to create the missing third row.
\end_layout

\end_inset

.
 Because the third line is just the total of the first two, it isn't hard
 to calculate, if necessary.
 
\end_layout

\begin_layout Standard
The row labeled 
\family typewriter
Species
\family default
 corresponds to the difference between the simple and complex models, while
 the 
\family typewriter
Residuals
\family default
 row corresponds to the complex model.
 Notice that 
\begin_inset Formula $SSE_{diff}$
\end_inset

 is quite large, but to decide if it is large enough to justify the use
 of the complex model, we must go through the calculations to get the p-value,
 which is quite small.
 Because the p-value is smaller than any reasonable 
\begin_inset Formula $\alpha$
\end_inset

-level, we can reject the null hypothesis and conclude that at least one
 of the means is different than the others.
 
\end_layout

\begin_layout Standard
But which mean is different? The first thing to do is to look at the point
 estimates and confidence intervals for 
\begin_inset Formula $\mu_{i}$
\end_inset

.
 These are
\begin_inset Formula 
\begin{eqnarray*}
\hat{\mu}_{i} & = & \bar{y}_{i\cdot}
\end{eqnarray*}

\end_inset


\begin_inset Formula 
\[
\hat{y}_{i\cdot}\pm t_{n_{t}-k}^{1-\alpha/2}\left(\frac{\hat{\sigma}}{\sqrt{n_{i}}}\right)
\]

\end_inset

and can be found using the 
\family typewriter
coef()
\family default
 and 
\family typewriter
confint()
\family default
 functions.
\end_layout

\begin_layout Standard
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

# To get coefficients in the way we have represented the 
\end_layout

\begin_layout Plain Layout

# complex model (which we call the cell means model), we 
\end_layout

\begin_layout Plain Layout

# must add a -1 to the formula passed to aov()
\end_layout

\begin_layout Plain Layout

# We'll explore this more in section 5 of this chapter.
\end_layout

\begin_layout Plain Layout

model.2 <- aov(LAI ~ Species - 1, data=data)
\end_layout

\begin_layout Plain Layout

coef(model.2)
\end_layout

\begin_layout Plain Layout

confint(model.2)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Are the all the species different from each other? In practice I will want
 to examine each group and compare it to all others and figure out if they
 are different.
 How can we efficiently do all possible t-tests and keep the correct 
\begin_inset Formula $\alpha$
\end_inset

 level correct? 
\end_layout

\begin_layout Section
Multiple comparisons
\end_layout

\begin_layout Standard
Recall that for every statistical test there is some probability of making
 a type I error and we controlled that probability by setting a desired
 
\begin_inset Formula $\alpha$
\end_inset

-level.
 If I were to do 20 t-tests of samples with identical means, I would expect,
 on average, that one of them would turn up to be significantly different
 just by chance.
 If I am making a large number of tests, each with a type I error rate of
 
\begin_inset Formula $\alpha$
\end_inset

, I am practically guaranteed to make at least one type I error.
\end_layout

\begin_layout Standard
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<echo=FALSE, fig.height=4, fig.width=8>>=
\end_layout

\begin_layout Plain Layout

library(multcompView)
\end_layout

\begin_layout Plain Layout

par(mfrow=c(1,1))
\end_layout

\begin_layout Plain Layout

seed <- -1035 
\end_layout

\begin_layout Plain Layout

#seed <- round(rnorm(1, sd=1000))
\end_layout

\begin_layout Plain Layout

set.seed(seed) 
\end_layout

\begin_layout Plain Layout

k <- 5 
\end_layout

\begin_layout Plain Layout

n <- 10 
\end_layout

\begin_layout Plain Layout

Grp <- factor(rep(1:k, each=n)) 
\end_layout

\begin_layout Plain Layout

mu  <- rep(0, k*n) 
\end_layout

\begin_layout Plain Layout

y <- mu + rnorm(k*n) 
\end_layout

\begin_layout Plain Layout

mydata <- data.frame(Y=y, Group=Grp) 
\end_layout

\begin_layout Plain Layout

boxplot(Y~Group, data=mydata, ylim=c(-2.5, 3.2), 
\end_layout

\begin_layout Plain Layout

	main=expression(paste(X[ij],' ~ N(0,1)   where ', n[i], ' = 10')))
\end_layout

\begin_layout Plain Layout

p.values <- pairwise.t.test(mydata$Y, mydata$Group, pool.sd=FALSE,p.adjust.method='non
e')$p.value
\end_layout

\begin_layout Plain Layout

p.values <- cbind(rbind(rep(NA,k-1),p.values), rep(NA,k)) 
\end_layout

\begin_layout Plain Layout

rownames(p.values)[1] <- '1' 
\end_layout

\begin_layout Plain Layout

colnames(p.values)[k] <- k 
\end_layout

\begin_layout Plain Layout

letter <- multcompLetters(p.values, threshold=0.05) 
\end_layout

\begin_layout Plain Layout

for(i in 1:k){ 
\end_layout

\begin_layout Plain Layout

	text(i, 3, letter$Letters[i]) 
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
With 5 groups, there are 10 different comparisons to be made, and just by
 random chance, one of those comparisons might come up significant.
 In this sampled data, performing 10 different two sample t-tests without
 making any adjustments to our 
\begin_inset Formula $\alpha$
\end_inset

-level, we find one statistically significant difference even though all
 of the data came from a standard normal distribution.
\end_layout

\begin_layout Standard
I want to be able to control the family-wise error rate so that the probability
 that I make one or more type I errors in the set of 
\begin_inset Formula $m$
\end_inset

 of tests I'm considering is 
\begin_inset Formula $\alpha$
\end_inset

.
 One general way to do this is called the Bonferroni method.
 In this method each test is performed using a significance level of 
\begin_inset Formula $\alpha/m$
\end_inset

.
 (In practice I will multiple each p-value by 
\begin_inset Formula $m$
\end_inset

 and compare each p-value to my desired family-wise 
\begin_inset Formula $\alpha$
\end_inset

-level).
 Unfortunately for large 
\begin_inset Formula $m$
\end_inset

, this results in unacceptably high levels of type II errors.
 Fortunately there are other methods for addressing the multiple comparisons
 issue and they are built into R.
 
\end_layout

\begin_layout Standard
John Tukey's test of 
\begin_inset Quotes eld
\end_inset

Honestly Significant Differences
\begin_inset Quotes erd
\end_inset

 is commonly used to address the multiple comparisons issue when examining
 all possible pairwise contrasts.
 This method is available in R by the function 
\family typewriter
TukeyHSD
\family default
.
 This test is near optimal when each group has the same number of samples
 (which is often termed 
\begin_inset Quotes eld
\end_inset

a balanced design
\begin_inset Quotes erd
\end_inset

), but becomes more conservative (fails to detect differences) as the design
 becomes more unbalanced.
 In extremely unbalanced cases, it is preferable to use a Bonferroni adjustment.
\end_layout

\begin_layout Standard
Using TukeyHSD, the adjusted p-value for the difference between groups 1
 and 4 is no longer significant.
 
\end_layout

\begin_layout Standard
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

# TukeyHSD is very picky and will not accept Y ~ Group - 1
\end_layout

\begin_layout Plain Layout

model <- aov(Y~Group, mydata)
\end_layout

\begin_layout Plain Layout

TukeyHSD(model)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Likewise if we are testing the ANOVA assumption of equal variance, we cannot
 rely on doing all pairwise F-tests and we must use a method that controls
 the overall error rate.
 The multiple comparisons version of 
\family typewriter
var.test()
\family default
 is Bartlett's test which is called similarly to 
\family typewriter
aov()
\family default
.
\end_layout

\begin_layout Standard
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

bartlett.test(Y~Group, mydata)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Example
(Example 8.2 from the Ott and Longnecker) A clinical psychologist wished
 to compare three methods for reducing hostility levels in university students,
 and used a certain test (HLT) to measure the degree of hostility.
 A high score on the test indicated great hostility.
 The psychologist used 24 students who obtained high and nearly equal scores
 in the experiment.
 Eight subjects were selected at random from among the 24 problem cases
 and were treated with method 1, seven of the remaining 16 students were
 selected at random and treated with method 2 while the remaining nine students
 were treated with method 3.
 All treatments were continued for a one-semester period.
 Each student was given the HLT test at the end of the semester, with the
 results show in the following table.
 Use these dat to perform an analysis of variance to determine whether there
 are differences among the mean scores for the three methods using a significanc
e level of 
\begin_inset Formula $\alpha=0.05$
\end_inset

.
\end_layout

\begin_layout Example
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="10">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Method
\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Test Scores
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
96
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
79
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
91
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
85
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
83
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
91
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
82
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
87
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
77
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
76
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
74
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
73
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
78
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
71
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
80
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
66
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
73
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
69
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
66
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
77
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
73
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
71
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
70
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
74
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset

 
\end_layout

\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

# define the data
\end_layout

\begin_layout Plain Layout

Hostility <- data.frame(
\end_layout

\begin_layout Plain Layout

  HLT = c(96,79,91,85,83,91,82,87,
\end_layout

\begin_layout Plain Layout

          77,76,74,73,78,71,80,
\end_layout

\begin_layout Plain Layout

          66,73,69,66,77,73,71,70,74),
\end_layout

\begin_layout Plain Layout

  Method = c( rep('M1',8), rep('M2',7), rep('M3',9) ) )
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Newline newline
\end_inset

The first thing we will do (as we should do in all data analyses) is to
 graph our data.
 
\begin_inset Newline newline
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<fig.height=3>>=
\end_layout

\begin_layout Plain Layout

library(ggplot2)
\end_layout

\begin_layout Plain Layout

ggplot(Hostility, aes(x=Method, y=HLT)) +
\end_layout

\begin_layout Plain Layout

  geom_boxplot()
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Newline newline
\end_inset

These box plots make it clear that there is a difference between the three
 groups (at least group 
\family typewriter
M1
\family default
 is different from 
\family typewriter
M2
\family default
 or 
\family typewriter
M3
\family default
).
 An ANOVA model assumes equal variance between groups and that the residuals
 are normally distributed.
 Based on the box plot, the equal variance assumption might be suspect (although
 with only 
\begin_inset Formula $\approx8$
\end_inset

 observations per group, it might not be bad).
 We'll examine a QQ-plot of the residuals to consider the normality.
\end_layout

\begin_layout Standard
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<echo=TRUE, fig.height=3.5, fig.width=6>>=
\end_layout

\begin_layout Plain Layout

# Do the model assumptions hold?
\end_layout

\begin_layout Plain Layout

model <- aov( HLT ~ Method, data=Hostility )
\end_layout

\begin_layout Plain Layout

qqnorm( resid(model) )
\end_layout

\begin_layout Plain Layout

qqline( resid(model) )
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
To examine the Normality of the residuals, we'll use a Shapiro-Wilk's test
 and we'll also use Bartlett's test for homogeneity of variances.
\end_layout

\begin_layout Standard
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

# Test for Normality
\end_layout

\begin_layout Plain Layout

shapiro.test(resid(model))
\end_layout

\begin_layout Plain Layout

# Test for equal variances between groups
\end_layout

\begin_layout Plain Layout

bartlett.test(HLT~Method, data=Hostility)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The results of the Shapiro-Wilks test agree with the QQ-plot, and Bartlett's
 test fails to detect differences in the variances between the two groups.
 This is not to say that there might not be a difference, only that we do
 not detect one.
\end_layout

\begin_layout Standard
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

model <- aov( HLT ~ Method, data=Hostility )
\end_layout

\begin_layout Plain Layout

anova(model)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Because the p-value in the ANOVA table is smaller than 
\begin_inset Formula $\alpha=0.05,$
\end_inset

 we can reject the null hypothesis of equal means and conclude that at least
 one of the means is different from the others.
 Our estimate of 
\begin_inset Formula $\sigma^{2}$
\end_inset

 is 
\begin_inset Formula $18.44$
\end_inset

 so the estimate of 
\begin_inset Formula $\sigma=\sqrt{18.44}=4.294$
\end_inset

.
\end_layout

\begin_layout Standard
To find out which means are different we first look at the group means and
 confidence intervals.
\end_layout

\begin_layout Standard
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

# To get the group means from aov, we must
\end_layout

\begin_layout Plain Layout

# use the -1 in the formula command 
\end_layout

\begin_layout Plain Layout

model.2 <- aov( HLT ~ Method - 1, data=Hostility )
\end_layout

\begin_layout Plain Layout

coef(model.2)
\end_layout

\begin_layout Plain Layout

confint(model.2)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
To control for the multiple comparisons issue we again look at all possible
 group comparisons using the 
\family typewriter
TukeyHSD
\family default
 function.
\end_layout

\begin_layout Standard
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

# Remember TukeyHSD is picky and doesn't like the -1...
\end_layout

\begin_layout Plain Layout

TukeyHSD(model)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
If we feel uncomfortable with the equal variance assumption, we can do each
 pairwise t-test using non-pooled variance and then correct for the multiple
 comparisons using Bonferroni's p-value correction.
 If we have 
\begin_inset Formula $k=3$
\end_inset

 groups, the we have 
\begin_inset Formula $k(k-1)/2=3$
\end_inset

 different comparisons, so I will calculate each p-value and multiply by
 3.
\begin_inset Newline newline
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

pairwise.t.test(Hostility$HLT, Hostility$Method, 
\end_layout

\begin_layout Plain Layout

                pool.sd=FALSE, p.adjust.method='none')
\end_layout

\begin_layout Plain Layout

pairwise.t.test(Hostility$HLT, Hostility$Method, 
\end_layout

\begin_layout Plain Layout

                pool.sd=FALSE, p.adjust.method='bonferroni')
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Newline newline
\end_inset

Using the Bonferroni adjusted p-values, we continue to detect a statistically
 significant difference between Method 1 and both Methods 2 & 3, but do
 not detect a difference between Method 2 and Method 3.
\end_layout

\begin_layout Section
Different Model Representations
\end_layout

\begin_layout Subsection
Theory
\end_layout

\begin_layout Standard
We started with what I will call the 
\begin_inset Quotes eld
\end_inset

cell means model
\begin_inset Quotes erd
\end_inset


\begin_inset Formula 
\[
Y_{ij}=\mu_{i}+\epsilon_{ij}\;\;\;\textrm{where}\;\;\epsilon_{ij}\stackrel{iid}{\sim}N\left(0,\sigma^{2}\right)
\]

\end_inset

so that the 
\begin_inset Formula $E\left(Y_{ij}\right)=\mu_{i}$
\end_inset

 where I interpret 
\begin_inset Formula $\mu_{i}$
\end_inset

 as the mean of each population.
 Given some data, we the following graph where the red lines and numbers
 denote the observed mean of the data in each group :
\end_layout

\begin_layout Standard
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<echo=FALSE, fig.height=3>>=
\end_layout

\begin_layout Plain Layout

y <- c(3,4,5, 8,9,10, 13,14,15) 
\end_layout

\begin_layout Plain Layout

x <- c(0.9,1.0,1.1, 1.9,2.0,2.1, 2.9,3.0,3.1) 
\end_layout

\begin_layout Plain Layout

grp <- factor(c(1,1,1,2,2,2,3,3,3)) 
\end_layout

\begin_layout Plain Layout

ybars <- coef(aov(y~grp-1)) 
\end_layout

\begin_layout Plain Layout

ybar <- mean(y) 
\end_layout

\begin_layout Plain Layout

tau <- c(0, coef(aov(y~grp))[2:3]) 
\end_layout

\begin_layout Plain Layout

plot(x, y, type='p', axes=FALSE, xlab='Group', xlim=c(.8, 3.4), main='Complex
 Model') 
\end_layout

\begin_layout Plain Layout

box(); axis(2) 
\end_layout

\begin_layout Plain Layout

axis(1, at=c(1,2,3), labels=c(1,2,3))
\end_layout

\begin_layout Plain Layout

for( i in 1:3 ){ 
\end_layout

\begin_layout Plain Layout

	lines(c(i-.15, i+.15), rep(ybars[i],2), col='red', lw=2) 
\end_layout

\begin_layout Plain Layout

	text(i+.2, ybars[i], paste(ybars[i]), col='red') 
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
But I am often interested in the difference between one group and another.
 For example, suppose this data comes from an experiment and group 1 is
 the control group.
 Then perhaps what I'm really interested is not that group 2 has a mean
 of 9, but rather that it is 5 units larger than the control.
 In this case perhaps what we care about is the differences.
 I could re-write the group means in terms of these differences from group
 1.
 So looking at the model this way, the values that define the group means
 are the mean of group 1 (here it is 4), and the offsets from group 1 to
 group 2 (which is 5), and the offset from group 1 to group 3 (which is
 10).
\end_layout

\begin_layout Standard
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<echo=FALSE, fig.height=3>>=
\end_layout

\begin_layout Plain Layout

y <- c(3,4,5, 8,9,10, 13,14,15) 
\end_layout

\begin_layout Plain Layout

x <- c(0.9,1.0,1.1, 1.9,2.0,2.1, 2.9,3.0,3.1) 
\end_layout

\begin_layout Plain Layout

grp <- factor(c(1,1,1,2,2,2,3,3,3)) 
\end_layout

\begin_layout Plain Layout

ybars <- coef(aov(y~grp-1)) 
\end_layout

\begin_layout Plain Layout

ybar <- mean(y) 
\end_layout

\begin_layout Plain Layout

tau <- c(0, coef(aov(y~grp))[2:3]) 
\end_layout

\begin_layout Plain Layout

plot(x, y, type='p', axes=FALSE, xlab='Group', xlim=c(.8, 3.7), main='Complex
 Model') 
\end_layout

\begin_layout Plain Layout

box(); axis(2) 
\end_layout

\begin_layout Plain Layout

axis(1, at=c(1,2,3), labels=c(1,2,3))
\end_layout

\begin_layout Plain Layout

for( i in 1:3 ){ 
\end_layout

\begin_layout Plain Layout

	lines(c(i-.15, i+.15), rep(ybars[i],2), col='red', lw=2) 
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

text(1+.14, ybars[1], pos=4, '4', col='red') 
\end_layout

\begin_layout Plain Layout

text(2+.14, ybars[2], pos=4, '9 = 4 + 5', col='red') 
\end_layout

\begin_layout Plain Layout

text(3+.14, ybars[3], pos=4, '14 = 4 + 10', col='red') 
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
I could write this interpretation of the model as the 
\begin_inset Quotes eld
\end_inset

offset
\begin_inset Quotes erd
\end_inset

 model which is
\begin_inset Formula 
\[
Y_{ij}=\mu+\tau_{i}+\epsilon_{ij}
\]

\end_inset

where 
\begin_inset Formula $\mu$
\end_inset

 is the mean of group 1 and 
\begin_inset Formula $\tau_{i}$
\end_inset

 is each population's offset from group 1.
 Since group 1 can't be offset from itself, this forces 
\begin_inset Formula $\tau_{1}=0$
\end_inset

.
\end_layout

\begin_layout Standard
Notice that this representation of the complex model has 4 parameters (aside
 from 
\begin_inset Formula $\sigma$
\end_inset

), but it has an additional constraint so we still only have 3 parameters
 that can vary (just as the cell means model has 3 means).
\end_layout

\begin_layout Standard
The cell means model and the offset model really are the same model, just
 looked at slightly differently.
 They have the same number of parameters, and produce the same predicted
 values for 
\begin_inset Formula $\hat{y}_{ij}$
\end_inset

 and therefore have the same sum of squares, etc.
 The only difference is that one is might be more convenient depending on
 the question the investigator is asking.
 
\end_layout

\begin_layout Standard
Another way to write the cell means model is as
\begin_inset Formula 
\[
Y_{ij}=\mu+\tau_{i}+\epsilon_{ij}
\]

\end_inset

but with the constraint that 
\begin_inset Formula $\mu=0$
\end_inset

.
 It doesn't matter which constraint you use so long as you know which is
 being used because the interpretation of the values changes (group mean
 versus an offset from the reference group).
\end_layout

\begin_layout Subsection
Model Representations in R
\end_layout

\begin_layout Standard
To obtain the different representations within R, we will vary the formula
 to include or exclude the intercept term 
\begin_inset Formula $\mu$
\end_inset

.
 By default, R assumes you want the intercept term (offset representation)
 and you must use the 
\family typewriter
-1
\family default
 term in the formula for the cell means representation.
\end_layout

\begin_layout Standard
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

fake.data <- data.frame(   y =        c( 3,4,5,  8,9,10, 13,14,15),
\end_layout

\begin_layout Plain Layout

                         grp = factor(c( 1,1,1,  2,2,2,   3,3,3 )) )
\end_layout

\begin_layout Plain Layout

# Offset representation 
\end_layout

\begin_layout Plain Layout

#   Unless you have a -1, R implicitly  
\end_layout

\begin_layout Plain Layout

#   adds a "+1" to the formula, so 
\end_layout

\begin_layout Plain Layout

#   so the following statements are equivalent
\end_layout

\begin_layout Plain Layout

#c.model.1 <- aov(y ~ grp  , data=fake.data)
\end_layout

\begin_layout Plain Layout

 c.model.1 <- aov(y ~ grp+1, data=fake.data)
\end_layout

\begin_layout Plain Layout

coef(c.model.1)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
In the above case, we see R is giving the mean of group 1 and then the two
 offsets.
 
\end_layout

\begin_layout Standard
To force R to use the cell means model, we force R to use the constraint
 that 
\begin_inset Formula $\mu=0$
\end_inset

 by including a 
\family typewriter
-1
\family default
 in the model formula.
\end_layout

\begin_layout Standard
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

c.model.1 <- aov(y ~ grp -1, data=fake.data)
\end_layout

\begin_layout Plain Layout

coef(c.model.1)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Returning the hostility example, recall we used the cell means model and
 we can extract parameter coefficient estimates using the 
\family typewriter
coef
\family default
 function and ask for the appropriate confidence intervals using 
\family typewriter
confint()
\family default
.
\end_layout

\begin_layout Standard
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

model <- aov(HLT ~ Method - 1, data=Hostility)
\end_layout

\begin_layout Plain Layout

coef(model)
\end_layout

\begin_layout Plain Layout

confint(model)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
We can use the intercept model by removing 
\family typewriter
-1
\family default
 term from the formula.
 
\end_layout

\begin_layout Standard
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

model <- aov(HLT ~ Method, data=Hostility)
\end_layout

\begin_layout Plain Layout

coef(model)
\end_layout

\begin_layout Plain Layout

confint(model)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The intercept term in the offset representation corresponds to 
\family typewriter
Method1
\family default
 and the coefficients and confidence intervals are the same as in the cell
 means model.
 However in the offset model, 
\family typewriter
Method2
\family default
 is the 
\emph on
difference
\emph default
 between 
\family typewriter
Method1
\family default
 and 
\family typewriter
Method2
\family default
.
 Notice the coefficient is negative, thus telling us that 
\family typewriter
Method2
\family default
 has a smaller mean value than the reference group 
\family typewriter
Method1
\family default
.
 Likewise 
\family typewriter
Method3
\family default
 has a negative coefficient indicating that the 
\family typewriter
Method3
\family default
 group is lower than the reference group.
\end_layout

\begin_layout Standard
Similarly the confidence intervals for 
\family typewriter
Method2
\family default
 and 
\family typewriter
Method3
\family default
 are now confidence intervals for the 
\emph on
difference 
\emph default
between these methods and the reference group 
\family typewriter
Method1
\family default
.
\end_layout

\begin_layout Standard
Why would we ever want the offset model vs the cell means model? Often we
 are interested in testing multiple treatments against a control group and
 we only care about the change from the control.
 In that case, setting the control group to be the reference makes sense.
 
\end_layout

\begin_layout Standard
Neither representation is more powerful because on a very deep mathematical
 level, they are exactly the same model.
 Superficially though, one representation might be more convenient than
 the other in a given situation.
\end_layout

\begin_layout Subsection
Implications on the ANOVA table
\end_layout

\begin_layout Standard
We have been talking about the complex and simple models for our data but
 there is one more possible model, albeit not a very good one.
 I will refer to this as the 
\series bold
bad model
\series default
 because it is almost always a poor fitting model.
\begin_inset Formula 
\[
Y_{ij}=\epsilon_{ij}
\]

\end_inset

where 
\begin_inset Formula $\epsilon_{ij}\stackrel{iid}{\sim}N\left(0,\sigma^{2}\right)$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<echo=FALSE, fig.height=4>>=
\end_layout

\begin_layout Plain Layout

library(plyr)
\end_layout

\begin_layout Plain Layout

par(mfrow=c(1,3))
\end_layout

\begin_layout Plain Layout

mu <- c(3,4,6)  
\end_layout

\begin_layout Plain Layout

k <- length(mu) 
\end_layout

\begin_layout Plain Layout

sigma <- .2  
\end_layout

\begin_layout Plain Layout

n <- 5 
\end_layout

\begin_layout Plain Layout

jitter <- seq(-n,n,length=n)/(3*n) 
\end_layout

\begin_layout Plain Layout

# generate the data 
\end_layout

\begin_layout Plain Layout

data <- NULL   
\end_layout

\begin_layout Plain Layout

for(i in 1:k){ 
\end_layout

\begin_layout Plain Layout

  temp <- data.frame(Species=i, LAI=rnorm(5, mean=mu[i], sd=sigma))
\end_layout

\begin_layout Plain Layout

  data <- rbind(data, temp)  
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

# Complex Model 
\end_layout

\begin_layout Plain Layout

plot(x=c(0.5, k+.5), y=c(min(mu)-3*sigma, max(mu)+3*sigma),
\end_layout

\begin_layout Plain Layout

            type='n', axes=FALSE, ylab='', xlab='Group',
\end_layout

\begin_layout Plain Layout

           main='Complex Model', ylim=c(0,7))  
\end_layout

\begin_layout Plain Layout

axis(1, at=1:3); axis(2); box()  
\end_layout

\begin_layout Plain Layout

data.means <- ddply(data, ~Species, summarize, Grp.Mean=mean(LAI))  
\end_layout

\begin_layout Plain Layout

points(data$Species+jitter, data$LAI)    
\end_layout

\begin_layout Plain Layout

for(i in 1:k){   
\end_layout

\begin_layout Plain Layout

  lines(c(i-.5,i+.5), rep(data.means[i,'Grp.Mean'],2), col='red')  
\end_layout

\begin_layout Plain Layout

}  
\end_layout

\begin_layout Plain Layout

for(i in 1:k){      
\end_layout

\begin_layout Plain Layout

  for(j in 1:n){          
\end_layout

\begin_layout Plain Layout

    index <- (i-1)*n+j          
\end_layout

\begin_layout Plain Layout

    lines(rep(data[index,'Species']+jitter[j],2),
\end_layout

\begin_layout Plain Layout

          c(data.means[i,'Grp.Mean'], data[index, 'LAI']),
\end_layout

\begin_layout Plain Layout

          col='dark green')      
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

# Simple Model 
\end_layout

\begin_layout Plain Layout

plot(x=c(0.5, k+.5), y=c(min(mu)-3*sigma, max(mu)+3*sigma),
\end_layout

\begin_layout Plain Layout

            type='n', axes=FALSE, ylab='', xlab='Group',
\end_layout

\begin_layout Plain Layout

           main='Simple Model', ylim=c(0,7))  
\end_layout

\begin_layout Plain Layout

axis(1, at=1:3); axis(2); box()  
\end_layout

\begin_layout Plain Layout

ybar <- mean(data$LAI)
\end_layout

\begin_layout Plain Layout

points(data$Species+jitter, data$LAI)    
\end_layout

\begin_layout Plain Layout

abline(h=ybar, col='red')
\end_layout

\begin_layout Plain Layout

for(i in 1:k){      
\end_layout

\begin_layout Plain Layout

  for(j in 1:n){          
\end_layout

\begin_layout Plain Layout

    index <- (i-1)*n+j          
\end_layout

\begin_layout Plain Layout

    lines(rep(data[index,'Species']+jitter[j],2),
\end_layout

\begin_layout Plain Layout

          c(ybar, data[index, 'LAI']),
\end_layout

\begin_layout Plain Layout

          col='dark green')      
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

} 
\end_layout

\begin_layout Plain Layout

# Bad Model 
\end_layout

\begin_layout Plain Layout

plot(x=c(0.5, k+.5), y=c(min(mu)-3*sigma, max(mu)+3*sigma),
\end_layout

\begin_layout Plain Layout

            type='n', axes=FALSE, ylab='', xlab='Group',
\end_layout

\begin_layout Plain Layout

           main='Bad Model', ylim=c(0,7))  
\end_layout

\begin_layout Plain Layout

axis(1, at=1:3); axis(2); box()  
\end_layout

\begin_layout Plain Layout

ybar <- 0
\end_layout

\begin_layout Plain Layout

points(data$Species+jitter, data$LAI)    
\end_layout

\begin_layout Plain Layout

abline(h=ybar, col='red')
\end_layout

\begin_layout Plain Layout

for(i in 1:k){      
\end_layout

\begin_layout Plain Layout

  for(j in 1:n){          
\end_layout

\begin_layout Plain Layout

    index <- (i-1)*n+j          
\end_layout

\begin_layout Plain Layout

    lines(rep(data[index,'Species']+jitter[j],2),
\end_layout

\begin_layout Plain Layout

          c(ybar, data[index, 'LAI']),
\end_layout

\begin_layout Plain Layout

          col='dark green')      
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

} 
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Notice that the complex model has three parameters that define 
\begin_inset Quotes eld
\end_inset

signal
\begin_inset Quotes erd
\end_inset

 part of the model (i.e.
 the three group means).
 The simple has one parameter that defines the 
\begin_inset Quotes eld
\end_inset

signal
\begin_inset Quotes erd
\end_inset

 (the overall mean).
 The bad model has 
\emph on
no
\emph default
 parameters that define the model (i.e.
 the red line is always at zero).
 
\end_layout

\begin_layout Standard
These three models can be denoted in R by:
\end_layout

\begin_layout Itemize
Complex: 
\end_layout

\begin_deeper
\begin_layout Itemize
offset representation: 
\family typewriter
Y ~ group
\family default
 which R will recognize as 
\family typewriter
Y ~ group + 1
\end_layout

\begin_layout Itemize
cell means representation: 
\family typewriter
Y ~ group - 1
\end_layout

\end_deeper
\begin_layout Itemize
Simple: 
\family typewriter
Y ~ 1
\end_layout

\begin_layout Itemize
Bad: 
\family typewriter
Y ~ -1
\end_layout

\begin_layout Standard
In the analysis of variance table calculated by 
\family typewriter
anova()
\family default
, R has to decide which simple model to compare the complex model to.
 If you used the offset representation, then when 
\family typewriter
group
\family default
 is removed from the model, we are left with the model 
\family typewriter
Y ~ 1
\family default
, which is the simple model.
 If we wrote the complex model using the cell means representation, then
 when 
\family typewriter
group
\family default
 is removed, we are left with the model 
\family typewriter
Y ~ -1
\family default
 which is the bad model.
\end_layout

\begin_layout Standard
When we produce the ANOVA table compare the complex to the bad model, the
 difference in number of parameters between the models will be 3 (because
 I have to add three parameters to go from a signal line of 0, to three
 estimated group means).
 The ANOVA table comparing simple model to the complex will have a difference
 in number of parameters of 2 (because the simple mean has 1 estimated value
 compared to 3 estimated values).
\end_layout

\begin_layout Example*
Hostility Scores
\end_layout

\begin_layout Example*
We return to the hostility scores example and we will create the two different
 model representations in R and see how the ANOVA table produced by R differs
 between the two.
 
\end_layout

\begin_layout Standard
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

offset.representation <- aov(HLT ~ Method, data=Hostility)
\end_layout

\begin_layout Plain Layout

cell.representation   <- aov(HLT ~ Method -1, data= Hostility)
\end_layout

\begin_layout Plain Layout

#
\end_layout

\begin_layout Plain Layout

#
\end_layout

\begin_layout Plain Layout

# This is the ANOVA table we want, comparing Complex to Simple
\end_layout

\begin_layout Plain Layout

# Notice the df of the difference between the models is 3-1 = 2
\end_layout

\begin_layout Plain Layout

anova(offset.representation)
\end_layout

\begin_layout Plain Layout

#
\end_layout

\begin_layout Plain Layout

#
\end_layout

\begin_layout Plain Layout

# This is the ANOVA table comparing the Complex to the BAD model
\end_layout

\begin_layout Plain Layout

# Noice the df of the difference between the models is 3-0 = 3
\end_layout

\begin_layout Plain Layout

anova(cell.representation)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Because the bad model is 
\emph on
extremely
\emph default
 bad in this case, the F-statistic for comparing the complex to the bad
 model is extremely large (F=2631).
 The complex model is also superior to the simple model, but not by as emphatica
lly (F=29).
\end_layout

\begin_layout Standard
One way to be certain which models you are comparing is to explicitly choose
 the two models.
\end_layout

\begin_layout Standard
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

simple <- aov(HLT ~ 1, data=Hostility)
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

# create the ANOVA table comparing the complex model (using the 
\end_layout

\begin_layout Plain Layout

# cell means representation) to the simple model.
 
\end_layout

\begin_layout Plain Layout

# The output shown in the following contains all the
\end_layout

\begin_layout Plain Layout

# necessary information, but is arranged slightly differently.
\end_layout

\begin_layout Plain Layout

anova(simple, cell.representation)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Exercises
\end_layout

\begin_layout Enumerate
For this exercise, we will compare the Sums of Squared Error for the simple
 
\begin_inset Formula 
\[
y_{ij}=\mu+\epsilon_{ij}
\]

\end_inset

and complex
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula 
\[
y_{ij}=\mu_{i}+\epsilon_{ij}
\]

\end_inset

model
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
 and clearly, in the data presented below, the complex model fits the data
 better.
 The group means 
\begin_inset Formula $\bar{y}_{i\cdot}$
\end_inset

 are 3, 13, 5, and 9, while the overall mean is 
\begin_inset Formula $\bar{y}_{\cdot\cdot}=7.5$
\end_inset

.
\begin_inset Newline newline
\end_inset

 
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<echo=FALSE, fig.height=3>>=
\end_layout

\begin_layout Plain Layout

library(ggplot2)
\end_layout

\begin_layout Plain Layout

Simple.data <- data.frame( 
\end_layout

\begin_layout Plain Layout

y = c(2,3,4,5, 12,13,14,15, 7,6,5,4, 8,9,10,11 )-.5,
\end_layout

\begin_layout Plain Layout

grp = rep(c('A','B','C','D'), each=4),
\end_layout

\begin_layout Plain Layout

rep = factor(rep(1:4, times=4)),
\end_layout

\begin_layout Plain Layout

model = 'Simple Model') 
\end_layout

\begin_layout Plain Layout

Complex.data <- Simple.data
\end_layout

\begin_layout Plain Layout

Complex.data$model <- 'Complex Model'
\end_layout

\begin_layout Plain Layout

Full.data <- rbind(Simple.data, Complex.data) 
\end_layout

\begin_layout Plain Layout

ggplot(Full.data, aes(x=grp, y=y, grp=rep, shape=grp, color=grp)) +
\end_layout

\begin_layout Plain Layout

geom_pointrange(aes(ymin=y, ymax=y), position=position_dodge(width=.6)) +
 
\end_layout

\begin_layout Plain Layout

scale_y_continuous(breaks=c(3,5,7,9,11,13,15)) + 
\end_layout

\begin_layout Plain Layout

xlab('Group') + 
\end_layout

\begin_layout Plain Layout

facet_grid(.
 ~ model) 
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
For the simple model graph, draw a horizontal line at the height of the
 overall mean, representing predicted value of a new observation.
 Next, draw the the corresponding residuals 
\begin_inset Formula $y_{ij}-\bar{y}_{\cdot\cdot}$
\end_inset

 as vertical lines from the data points to the overall mean.
 Similarly draw horizontal lines for the group means in the complex model
 and represent the residuals for the complex model 
\begin_inset Formula $y_{ij}-\bar{y}_{i\cdot}$
\end_inset

 as vertical lines from the data points to the group means.
 In this case, does it appear that the average residual is significantly
 larger in the simple model than the complex?
\begin_inset VSpace 0.4in
\end_inset


\end_layout

\begin_layout Enumerate
To show that the complex is a significantly better model, fill in the empty
 boxes in the ANOVA table.
\begin_inset Newline newline
\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="6">
<features rotate="0" tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Source
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Sum of Squares
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
df
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mean Squares
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
F-stat
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
P-value
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Difference
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Complex
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
20
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
12
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Simple
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
256
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
15
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate
We will essentially repeat the previous exercise, except this time, the
 simple model will be preferred.
 
\begin_inset Newline newline
\end_inset

 
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<echo=FALSE, fig.height=2.5>>=
\end_layout

\begin_layout Plain Layout

\begin_inset Argument 1
status open

\begin_layout Plain Layout
, fig.width=6, message=FALSE
\end_layout

\end_inset

set.seed(238)
\end_layout

\begin_layout Plain Layout

Simple.data <- data.frame( 
\end_layout

\begin_layout Plain Layout

y = rnorm(9, mean=5), 
\end_layout

\begin_layout Plain Layout

grp = rep(c('A','B','C'), each=3), 
\end_layout

\begin_layout Plain Layout

rep = factor(rep(1:3, times=3)), 
\end_layout

\begin_layout Plain Layout

model = 'Simple Model') 
\end_layout

\begin_layout Plain Layout

Complex.data <- Simple.data
\end_layout

\begin_layout Plain Layout

Complex.data$model <- 'Complex Model'
\end_layout

\begin_layout Plain Layout

Full.data <- rbind(Simple.data, Complex.data) 
\end_layout

\begin_layout Plain Layout

ggplot(Full.data, aes(x=grp, y=y, grp=rep, shape=grp, color=grp)) +
\end_layout

\begin_layout Plain Layout

geom_pointrange(aes(ymin=y, ymax=y), position=position_dodge(width=.6)) +
 
\end_layout

\begin_layout Plain Layout

xlab('Group') + 
\end_layout

\begin_layout Plain Layout

facet_grid(.
 ~ model) 
\end_layout

\begin_layout Plain Layout

# make a data frame to show the students...
\end_layout

\begin_layout Plain Layout

p2.data <- Simple.data[,c('y','grp')]
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Newline newline
\end_inset

For this data, the following means can be calculated:
\begin_inset Newline newline
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

library(dplyr)
\end_layout

\begin_layout Plain Layout

str(p2.data)
\end_layout

\begin_layout Plain Layout

# calculate the group means
\end_layout

\begin_layout Plain Layout

p2.data %>% group_by(grp) %>% summarise(xbar.i = mean(y))
\end_layout

\begin_layout Plain Layout

# calculate the overall mean
\end_layout

\begin_layout Plain Layout

p2.data %>% summarise(xbar = mean(y))
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
For the simple model graph, draw the corresponding residuals 
\begin_inset Formula $y_{ij}-\bar{y}_{\cdot\cdot}$
\end_inset

 as vertical lines from the data point to the overall mean.
 Similarly draw the residuals for the complex model 
\begin_inset Formula $y_{ij}-\bar{y}_{i\cdot}$
\end_inset

 as vertical lines from the data points to the group means.
 (Visually estimate the group and overall means).
 In this case, does it appear that the average residual is significantly
 larger in the simple model than the complex?
\begin_inset VSpace 0.4in
\end_inset


\end_layout

\begin_layout Enumerate
To show that the complex not a significantly better model, fill in the empty
 boxes in the ANOVA table.
\begin_inset Newline newline
\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="6">
<features rotate="0" tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Source
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Sum of Squares
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
df
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mean Squares
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
F-stat
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
P-value
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Difference
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Complex
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8.75
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Simple
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
9.79
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Newpage newpage
\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate
The following data were collected and we wish to perform an analysis of
 variance to determine if the group means are statistically different.
\begin_inset Newline newline
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Group 1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Group 2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Group 3
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $4,6,6,8$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $8,8,6,6$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $12,13,15,16$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
The complex model assumes different means for each group.
 That is 
\begin_inset Formula 
\[
Y_{ij}=\mu_{i}+\epsilon_{ij}
\]

\end_inset

Calculate 
\begin_inset Formula $SSE_{complex}$
\end_inset

 via the following:
\end_layout

\begin_deeper
\begin_layout Enumerate
Find the estimate of 
\begin_inset Formula $\mu_{i}$
\end_inset

.
 That is, calculate 
\begin_inset Formula $\hat{\mu}_{i}=\bar{y}_{i\cdot}$
\end_inset

 which is the mean of each group.
 Therefore the predicted value for a new observation in group 
\begin_inset Formula $i$
\end_inset

 would be 
\begin_inset Formula $\hat{y}_{ij}=\hat{\mu}_{i}=\bar{y}_{i\cdot}$
\end_inset

 and you can now calculate 
\begin_inset Formula $SSE_{complex}$
\end_inset

.
\end_layout

\begin_layout Enumerate
Calculate
\begin_inset Formula 
\[
SSE_{complex}=\sum_{i=1}^{3}\sum_{j=1}^{4}\left(y_{ij}-\hat{y}_{ij}\right)^{2}=\sum_{i=1}^{3}\sum_{j=1}^{4}\left(y_{ij}-\bar{y}_{\cdot\cdot}\right)^{2}
\]

\end_inset

 
\begin_inset VSpace 1.5in
\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate
The simple model assumes the same mean for each group.
 That is 
\begin_inset Formula 
\[
Y_{ij}=\mu+\epsilon_{ij}
\]

\end_inset

Calculate 
\begin_inset Formula $SSE_{simple}$
\end_inset

 via the following:
\end_layout

\begin_deeper
\begin_layout Enumerate
Find the estimate of 
\begin_inset Formula $\mu$
\end_inset

.
 That is, calculate 
\begin_inset Formula $\hat{\mu}=\bar{y}_{\cdot\cdot}$
\end_inset

 which is the overall mean of all the data.
 Therefore the predicted value for a new observation in any group would
 be 
\begin_inset Formula $\hat{y}_{ij}=\hat{\mu}=\bar{y}_{\cdot\cdot}$
\end_inset

 and we can calculate 
\begin_inset Formula $SSE_{simple}$
\end_inset


\end_layout

\begin_layout Enumerate
Calculate 
\begin_inset Formula 
\[
SSE_{simple}=\sum_{i=1}^{3}\sum_{j=1}^{4}\left(y_{ij}-\hat{y}_{ij}\right)^{2}=\sum_{i=1}^{3}\sum_{j=1}^{4}\left(y_{ij}-\bar{y}_{\cdot\cdot}\right)^{2}
\]

\end_inset


\begin_inset VSpace 1.5in
\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate
Recreate the ANOVA table using R by typing in the data set and fitting the
 appropriate model using the 
\family typewriter
aov()
\family default
 command.
 Obtain the ANOVA table from this model by using the 
\family typewriter
anova()
\family default
 command.
\begin_inset Newpage newpage
\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate
Suppose that for a project I did four separate t-tests and the resulting
 p-values were
\begin_inset Newline newline
\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="4">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $p_{1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $p_{2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $p_{3}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $p_{4}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.03$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.14$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.01$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.001$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset

 
\begin_inset Newline newline
\end_inset


\begin_inset Newline newline
\end_inset

If I wanted to control my overall type I error rate at an 
\begin_inset Formula $\alpha=0.05$
\end_inset

 and used the Bonferroni multiple comparisons procedure, which tests would
 be statistically significant?
\end_layout

\begin_layout Enumerate
We will examine the amount of waste produced at five different plants that
 manufacture Levi Jeans.
 The 
\family typewriter
Waste
\family default
 amount is the amount of cloth wasted in cutting out designs compared to
 a computer program, so negative values for 
\family typewriter
Waste 
\family default
indicate that the human engineer did a better job planning the cuts than
 the computer algorithm.
 The data are available in the file 
\begin_inset Quotes eld
\end_inset

Levi.csv
\begin_inset Quotes erd
\end_inset

 available on Bblearn.
 There are two columns, 
\family typewriter
Plant
\family default
 and 
\family typewriter
Waste
\family default
.
 
\end_layout

\begin_deeper
\begin_layout Enumerate
Read the data into R.
 If you need more help on this, see the chapter on importing data in the
 
\begin_inset CommandInset href
LatexCommand href
name "R manual: "
target "https://raw.github.com/dereksonderegger/STA_570L_Book/master/Introduction_to_R.pdf"

\end_inset

 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://raw.github.com/dereksonderegger/STA_570L_Book/master/Introduction_to_R.pdf
\end_layout

\end_inset

.
\end_layout

\begin_deeper
\begin_layout Enumerate
Download the file 
\family typewriter
Levi.csv
\family default
 from 
\begin_inset CommandInset href
LatexCommand href
name "GitHub"
target "https://raw.github.com/dereksonderegger/STA_570_Book/master/data/Levi.csv"

\end_inset

 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://raw.github.com/dereksonderegger/STA_570_Book/master/data/Levi.csv
\end_layout

\end_inset

 to some location on your computer (wherever you store RMarkdown files for
 your homework assignments).
 Open this file using a simple editor (Notepad on Windows or TextEdit on
 a Mac) and notice that the first line is a set of column headers and subsequent
 lines have the data.
 Also notice that the columns are separated by commas.
 This file type is known as a 
\begin_inset Quotes eld
\end_inset

comma separated values
\begin_inset Quotes erd
\end_inset

 file and MS Excel can open it just fine and Excel can save files in this
 file type as well.
\end_layout

\begin_layout Enumerate
Make sure the working directory in R is set to the same directory.
 In RStudio, this is under the menu item: Tools -> Set Working Directory.
 
\end_layout

\begin_layout Enumerate
Read in the file using the following command:
\begin_inset Newline newline
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<eval=FALSE>>=
\end_layout

\begin_layout Plain Layout

# First term is the file name, 
\end_layout

\begin_layout Plain Layout

# second is that the first row is the column headers, 
\end_layout

\begin_layout Plain Layout

# last is that a comma separates the columns from one another
\end_layout

\begin_layout Plain Layout

Levi <- read.table('Levi.csv', header=TRUE, sep=',')
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
Examine the data frame using the 
\family typewriter
str(Levi)
\family default
 command.
 Is the 
\family typewriter
Plant
\family default
 column already a factor, or do you need to convert it to a factor?
\end_layout

\end_deeper
\begin_layout Enumerate
Make a boxplot of the data.
 Do any assumptions necessary for ANOVA appear to be violated?
\end_layout

\begin_layout Enumerate
Test the equal variance assumption using Bartlett's test.
\end_layout

\begin_layout Enumerate
Fit an ANOVA model to these data and test if the residuals have a normal
 distribution using the Shapiro-Wilks test.
\end_layout

\end_deeper
\begin_layout Enumerate
The dataset 
\family typewriter
iris
\family default
 is available on R and can be loaded by the entering the command 
\family typewriter
data('iris')
\family default
 at your R prompt.
 This famous (Fisher's or Anderson's) iris data set gives the measurements
 in centimeters of the variables sepal length and width and petal length
 and width, respectively, for 
\begin_inset Formula $n_{i}=50$
\end_inset

 flowers from each of 3 species of iris.
 The species are 
\emph on
Iris setosa
\emph default
, 
\emph on
versicolor
\emph default
, and 
\emph on
virginica
\emph default
.
 We will be examining the relationship between sepal width and the species
 of these irises.
\begin_inset Newline newline
\end_inset


\begin_inset Newline newline
\end_inset

Denote the mean value of all 
\emph on
setosa
\emph default
 flowers as 
\begin_inset Formula $\mu_{setosa}$
\end_inset

 and similar notation for the other species.
\end_layout

\begin_deeper
\begin_layout Enumerate
Make a boxplot of the data.
 Do any assumptions necessary for ANOVA appear to be violated?
\end_layout

\begin_layout Enumerate
Test the equal variance assumption of ANOVA using Bartlett's test.
\end_layout

\begin_layout Enumerate
Do the ANOVA test using the command 
\family typewriter

\begin_inset Newline newline
\end_inset


\family default

\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<eval=FALSE>>=
\end_layout

\begin_layout Plain Layout

model <- aov( Sepal.Width ~ Species, data=iris)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\family typewriter

\begin_inset Newline newline
\end_inset


\family default
and test the normality of the residual terms by making a QQplot and doing
 the Shapiro-Wilk's test.
\end_layout

\begin_layout Enumerate
Examine the ANOVA table.
 What is the p-value for testing the hypotheses
\begin_inset Formula 
\begin{eqnarray*}
H_{0}:\, &  & \mu_{setosa}=\mu_{virginica}=\mu_{versicolor}\\
H_{a:\,} &  & \textrm{at least on mean is different}
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Enumerate
Now that we know there is a statistically significant difference amongst
 the means (and with 
\emph on
setosa
\emph default
 having a mean 
\family typewriter
Sepal.Width
\family default
 about 30% larger than the other two, I think aesthetically that is a big
 difference), we can go searching for it.
 Use Tukey's 
\begin_inset Quotes eld
\end_inset

Honestly Significant Differences
\begin_inset Quotes erd
\end_inset

 method to test all the pairwise comparisons between means.
 In particular, what is the p-value for testing
\begin_inset Formula 
\begin{eqnarray*}
H_{0}:\, &  & \mu_{setosa}=\mu_{virginica}\\
H_{a}:\: &  & \mu_{setosa}\ne\mu_{virginica}
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Enumerate
Refit the model using the 
\begin_inset Quotes eld
\end_inset


\family typewriter
-1
\family default

\begin_inset Quotes erd
\end_inset

 term 
\family typewriter

\begin_inset Newline newline
\end_inset


\family default

\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<eval=FALSE>>=
\end_layout

\begin_layout Plain Layout

model.2 <- aov( Sepal.Width ~ -1 + Species, data=iris)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
Using this second model and the function 
\family typewriter
coef()
\family default
, what is the estimated value of 
\begin_inset Formula $\mu_{setosa}$
\end_inset

? What is the estimated value of 
\begin_inset Formula $\mu_{virginica}$
\end_inset

?
\end_layout

\begin_layout Enumerate
What is the estimated value of 
\begin_inset Formula $\sigma^{2}$
\end_inset

? 
\end_layout

\begin_layout Enumerate
By hand, calculate the appropriate 95% confidence interval for 
\begin_inset Formula $\mu_{setosa}$
\end_inset

.
\end_layout

\begin_layout Enumerate
Using the R function 
\family typewriter
confint()
\family default
, confirm your calculation in part (h).
\end_layout

\end_deeper
\end_body
\end_document
