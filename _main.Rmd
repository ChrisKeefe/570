--- 
title: "Introduction to Statistical Methodology"
author: "Derek L. Sonderegger"
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
output: bookdown::gitbook
documentclass: book
bibliography: [book.bib, packages.bib]
biblio-style: apalike
link-citations: yes
github-repo: dereksonderegger/STA_570_Book
description: ""
---

```{r, echo=FALSE}
# Unattach any packages that happen to already be loaded. In general this is unecessary
# but is important for the creation of the book to not have package namespaces
# fighting unexpectedly.
pkgs = names(sessionInfo()$otherPkgs)
if( length(pkgs > 0)){
  pkgs = paste('package:', pkgs, sep = "")
  for( i in 1:length(pkgs)){
    detach(pkgs[i], character.only = TRUE, force=TRUE)
  }
}
```

# Summary Statistics and Graphing

When confronted with a large amount of data, we seek to summarize the data into statistics that somehow capture the essence of the data with as few numbers as possible. Graphing the data has a similar goal... to reduce the data to an image that represents all the key aspects of the raw data. In short, we seek to simplify the data in order to understand the trends while not obscuring important structure. 


```{r, message=FALSE, warning=FALSE}
# Every chapter, we will load all the librarys we will use at the beginning
# of the chapter. If you
library(mosaicData) # library of datasets we'll use
library(ggplot2)    # graphing functions
library(dplyr)      # data summary tools
```

For this chapter, we will consider data from a the 2005 Cherry Blossom 10 mile run that occurs in Washington DC. This data set has 8636 observations that includes the runners state of residence, official time (gun to finish, in seconds), net time (start line to finish, in seconds), age, and gender of the runners. 

```{r}
head(TenMileRace)   # examine the first few rows of the data
```

In general, I often need to make a distinction between two types of data.

* Discrete (also called Categorical) data is data that can only take a small set of particular values. For example a college student's grade can be either A, B, C, D, or F. A person's sex can be only Male or Female.Actually this isn't true as both gender and sex are far more complex. However from a statistical point of view it is often useful to simplify our model of the world. George Box famously said, “All models are wrong, but some are useful.” Discrete data could also be numeric, for example a bird could lay 1, 2, 3, ... eggs in a breeding season. 
* Continuous data is data that can take on an infinite number of numerical values. For example a person's height could be 68 inches, 68.2 inches, 68.23212 inches. 
    
To decided if a data attribute is discrete or continuous, I often as “Does a fraction of a value make sense?” If so, then the data is continuous. 

## Graphical summaries of data

### Univariate - Categorical

If we have univariate data about a number of groups, often the best way to display it is using barplots. They have the advantage over pie-charts that groups are easily compared. 

```{r}
ggplot(TenMileRace, aes(x=sex)) + geom_bar()
```

### Univariate - Continuous

A histogram looks very similar to a bar plot, but is used to represent continuous data instead of categorical and therefore the bars will actually be touching. 

```{r, warning=FALSE, message=FALSE}
ggplot(TenMileRace, aes(x=net)) + geom_histogram()
```

Often when a histogram is presented, the y-axis is labeled as “frequency” or “count” which is the number of observations that fall within a particular bin. However, it is often desirable to scale the y-axis so that if we were to sum up the area $(height * width)$ then the total area would sum to 1. The rescaling that accomplishes this is $$density=\frac{\#\;observations\;in\;bin}{total\;number\;observations}\cdot\frac{1}{bin\;width}$$
 

### Bivariate - Categorical vs Continuous

We often wish to compare response levels from two or more groups of interest. To do this, we often use side-by-side boxplots. Notice that each observation is associated with a continuous response value and a categorical value. 

```{r}
ggplot(TenMileRace, aes(x=sex, y=net)) + geom_boxplot()
```

In this graph, the edges of the box are defined by the 25% and 75% quantiles. That is to say, 25% of the data is to the below of the box, 50% of the data is in the box, and the final 25% of the data is to the above of the box. The dots are data points that traditionally considered outliers.Define the Inter-Quartile Range (IQR) as the length of the box. Then any observation more than 1.5*IQR from the box is considered an outlier. 

Sometimes I think that box-and-whisker plot obscures too much of the details of the data and we should look at the side-by-side histograms instead.

```{r, warning=FALSE, message=FALSE}
ggplot(TenMileRace, aes(x=net)) +
  geom_histogram() +
  facet_grid( . ~ sex )  # side-by-side plots based on sex
```

Orientation of graphs can certainly matter. In this case, it makes sense to stack the two graphs to facilitate comparisons.

```{r}
ggplot(TenMileRace, aes(x=net)) +
  geom_histogram() +
  facet_grid( sex ~ . )  # side-by-side plots based on sex
```


### Bivariate - Continuous vs Continuous

Finally we might want to examine the relationship between two continuous random variables.

```{r}
ggplot(TenMileRace, aes(x=age, y=net, color=sex)) +
  geom_point()
```

## Measures of Centrality

The most basic question to ask of any dataset is 'What is the typical value?' There are several ways to answer that question and they should be familiar to most students.

### Mean

Often called the average, or arithmetic mean, we will denote this special statistic with a bar. We define $$\bar{x}=\frac{1}{n}\sum_{i=1}^{n}x_{i}=\frac{1}{n}\left(x_{1}+x_{2}+\dots+x_{n}\right)$$
 

If we want to find the mean of five numbers $\left\{ 3,6,4,8,2\right\}$  the calculation is 
$$\bar{x}	=	\frac{1}{5}\left(3+6+4+8+2\right)
	=	\frac{1}{5}\left(23\right)
	=	23/5
	=	4.6$$
 

This can easily be calculated in R by using the function `mean()`. We first extract the column we are interested in using the notation: `DataSet$ColumnName` where the $ signifies grabbing the column.

```{r}
mean( TenMileRace$net ) # Simplest way of doing this calculation
TenMileRace %>% summarise( mean(net) )  # using the dplyr package
```

### Median

If the data were to be ordered, the median would be the middle most observation (or, in the case that $n$ is even, the mean of the two middle most values).

In our simple case of five observations $\left\{ 3,6,4,8,2\right\}$, we first sort the data into $\left\{ 2,3,4,6,8\right\}$  and then the middle observation is clearly $4$.

In R the median is easily calculated by the function `median()`.

```{r}
# median( TenMileRace$net )
TenMileRace %>% summarise( median(net) ) 
```

### Mode

This is the observation value with the most number of occurrences. This measure of "center" is not often used

### Examples 

* If my father were to become bored with retirement and enroll in my STA 570 course, how would that affect the mean and median age of my 570 students? 
    + The mean would move much more than the median. Suppose the class has 5 people right now, ages 21, 22, 23, 23, 24 and therefore the median is 23. When my father joins, the ages will be 21, 22, 23, 23, 24, 72 and the median will remain 23. However, the mean would move because we add in such a large outlier. Whenever we are dealing with skewed data, the mean is pulled toward the outlying observations.
* In 2010, the median NFL player salary was $770,000 while the mean salary was $1.9 million. Why the difference? 
    + Because salary data is skewed superstar players that make huge salaries (in excess of 20 million) while the minimum salary for a rookie is $375,000. Financial data often reflects a highly skewed distribution and the median is often a better measure of centrality in these cases.

## Measures of Variation

The second question to ask of a dataset is 'How much variability is there?' Again there are several ways to measure that.

### Range

Range is the distance from the largest to the smallest value in the dataset.

```{r}
#vmax( TenMileRace$net ) - min( TenMileRace$net )
TenMileRace %>% summarise( range = max(net) - min(net) )
```

### Inter-Quartile Range

The p-th percentile is the observation (or observations) that has at most $p$ percent of the observations below it and $(1-p)$ above it, where $p$ is between 0 and 100. The median is the $50$th percentile. Often we are interested in splitting the data into four equal sections using the $25$th, $50$th, and $75$th percentiles (which, because it splits the data into four sections, we often call these the $1$st, $2$nd, and $3$rd quartiles). 

In general I could be interested in dividing my data up into an arbitrary number of sections, and refer to those as quantiles of my data.

```{r}
quantile( TenMileRace$net ) # this works
# I can't do the following because the quantile() function spits out 5 values, not 1
# TenMileRace %>% summarise( quantile(net) )  
```

The inter-quartile range (IQR) is defined as the distance from the $3$rd quartile to the $1$st. 

```{r}
# IQR( TenMileRace$net )
TenMileRace %>% summarise( IQR(net) ) 
```


Notice that we've defined IQR before when we looked at box-and-whisker plots and this is exactly the length of the box. 

### Variance

One way to measure the spread of a distribution is to ask “what is the typical distance of an observation to the mean?” We could define the $i$th deviate as 
$$e_{i}=x_{i}-\bar{x}$$
and then ask what is the average deviate? The problem with this approach is that the sum (and thus the average) of all deviates is always 0.
$$\sum_{i=1}^{n}(x_{i}-\bar{x})	=	\sum_{i=1}^{n}x_{i}-\sum_{i=1}^{n}\bar{x}
	=	n\frac{1}{n}\sum_{i=1}^{n}x_{i}-n\bar{x}
	=	n\bar{x}-n\bar{x}
	=	0$$
 
The big problem is that about half the deviates are negative and the others are positive. What we really care is the distance from the mean, not the sign. So we could either take the absolute value, or square it. 

There are some really good theoretical reasons to chose the square option. Squared terms are easier to deal with compared to absolute values, but more importantly, the spread of the normal distribution is parameterized via squared distances from the mean. Because the normal distribution is so important, we've chosen to define the sample variance so it matches up with the natural spread parameter of the normal distribution. So we square the deviates and then find the average deviate size (approximately) and call that the sample variance.
$$s^{2}=\frac{1}{n-1}\sum_{i=1}^{n}\left(x_{i}-\bar{x}\right)^{2}$$
 Why do we divide by $n-1$ instead of $n$? 

1. If I divide by $n$, then on average, we would tend to underestimate the population variance $\sigma^{2}$. 
2.  The reason is because we are using the same set of data to estimate $\sigma^{2}$ as we did to estimate the population mean ($\mu$). If I could use   
    $$\frac{1}{n}\sum_{i=1}^{n}\left(x_{i}-\mu\right)^{2}$$
    as my estimator, we would be fine. But because I have to replace $\mu$ with $\bar{x}$ we have to pay a price.
3. Because the estimation of $\sigma^{2}$ requires the estimation of one other quantity, and using using that quantity, you only need $n-1$ data points and can then figure out the last one, we have used one degree of freedom on estimating the mean and we need to adjust the formula accordingly.

In later chapters we'll give this quantity a different name, so we'll introduce the necessary vocabulary here. Let $e_{i}=x_{i}-\bar{x}$ be the error left after fitting the sample mean. This is the deviation from the observed value to the “expected value” $\bar{x}$. We can then define the Sum of Squared Error as $$SSE=\sum_{i=1}^{n}e_{i}^{2}$$
 

and the Mean Squared Error as $$MSE=\frac{SSE}{df}=\frac{SSE}{n-1}=s^{2}$$
 where $df=n-1$ is the appropriate degrees of freedom.

Calculating the variance of our small sample of five observations $\left\{ 3,6,4,8,2\right\}$, recall that the sample mean was $\bar{x}=4.6$ 

$x_i$   |  $(x_i-\bar{x})$  | $(x_i-\bar{x})^2$ 
--------|-------------------|--------------------
  3     |       -1.6        |    2.56
  6     |        1.4        |    1.96
  4     |       -0.6        |    0.36
  8     |        3.4        |   11.56
  2     |       -2.6        |    6.76
--------|-------------------|--------------------  
        |                   |  SSE = 23.2
        
and so the sample variance is $$s^2 = \frac{23.2}{(n-1)} = \frac{23.2}{4}=5.8$$
 
Clearly this calculation would get very tedious to do by hand and computers will be much more accurate in these calculations. In R, the sample variance is easily calculated by the function var().

```{r}
ToyData <- data.frame( x=c(3,6,4,8,2) )
# var( ToyData$x )
ToyData %>% summarise( s2 = var(x) )
```

For the larger TenMileRace data set, the variance is just as easily calculated.

```{r}
# var( TenMileRace$net )
TenMileRace %>% summarise( s2 = var(net) )
```

### Standard Deviation

The biggest problem with the sample variance statistic is that the units are in the original units-squared. That means if you are looking at data about car fuel efficiency, then the values would be in mpg$^{2}$ which are units that I can't really understand. The solution is to take the positive square root, which we will call the sample standard deviation. $$s=\sqrt{s^{2}}$$
 But why do we take the jog through through variance? Mathematically the variance is more useful and most distributions (such as the normal) are defined by the variance term. Practically though, standard deviation is easier to think about.

The sample standard deviation is important enough for R to have function that will calculate it for you. 

```{r}
# sd( TenMileRace$net )
TenMileRace %>% summarise( s = sd(net) )
```


### Coefficient of Variation

Suppose we had a group of animals and the sample standard deviation of the animals lengths was 15 cm. If the animals were elephants, you would be amazed at their uniformity in size, but if they were insects, you would be astounded at the variability. To account for that, the coefficient of variation takes the sample standard deviation and divides by the absolute value of the sample mean (to keep everything positive)

$$CV=\frac{s}{\vert\bar{x}\vert}$$

```{r}
TenMileRace %>% summarise( s = sd(net),
                           xbar = mean(net),
                           cv = s / abs(xbar) )
```

```{r}
# For fun, lets calculate these same statistics but separated by sex...
TenMileRace %>% 
  group_by(sex) %>%
  summarise( xbar = mean(net),
             s    = sd(net),
             cv   = s / abs(xbar) )
```

### Empirical Rule of Thumb

For any mound-shaped sample of data the following is a reasonable rule of thumb:

  Interval        |     Approximate percent of Measurements
------------------|-------------------------------------------  
 $\bar{x}\pm s$   |               68%
 $\bar{x}\pm 2s$  |               95%
 $\bar{x}\pm 3s$  |               99.7%

```{r, echo=FALSE, warning=FALSE, message=FALSE}
n <- 1000
Line.Data <- data.frame(x=seq(-4,4,length=n)) %>%
  mutate(y=dnorm(x))
Text.Data1 <- data.frame(x=0, y=.25, label='bar(x) %+-% s',  group="1 Std Dev") %>%
        rbind(data.frame(x=0, y=.25, label='bar(x) %+-% 2*s', group="2 Std Dev")) %>%
        rbind(data.frame(x=0, y=.25, label='bar(x) %+-% 3*s', group="3 Std Dev")) 
Text.Data2 <- data.frame(x=0, y=.15, label='68%',   group="1 Std Dev") %>%
        rbind(data.frame(x=0, y=.15, label='95%',   group="2 Std Dev")) %>%
        rbind(data.frame(x=0, y=.15, label='99.7%', group="3 Std Dev")) 
Area.Data <- Line.Data %>% filter(abs(x)<1) %>% mutate(group="1 Std Dev")   %>%
      rbind( Line.Data %>% filter(abs(x)<2) %>% mutate(group="2 Std Dev") ) %>%
      rbind( Line.Data %>% filter(abs(x)<3) %>% mutate(group="3 Std Dev") ) 

ggplot( Area.Data, aes(x=x)) +
  geom_line( data=Line.Data, aes(x=x, y=y)) +
  geom_area(data=Area.Data, aes(x=x,y=y), fill='grey', alpha=.6) +
  geom_text( data=Text.Data1, aes(x=x, y=y, label=label), parse=TRUE) +
  geom_text( data=Text.Data2, aes(x=x, y=y, label=label)) +
  facet_grid( group ~ .) +
  labs(y='', x='') +
  scale_y_continuous(breaks=NULL) + 
  scale_x_continuous(     
    breaks=c(-3,-2,-1,0,1,2,3), minor_breaks = NULL,    
    labels = c( expression(bar(x)-3*s ),
                expression(bar(x)-2*s ),
                expression(bar(x)-s ),
                expression(bar(x)),
                expression(bar(x)+s ),
                expression(bar(x)+2*s),
                expression(bar(x)+3*s))) 
```

## Exercises

1. O&L 3.21. The ratio of DDE (related to DDT) to PCB concentrations in bird eggs has been shown to have had a number of biological implications. The ratio is used as an indication of the movement of contamination through the food chain. The paper “The ratio of DDE to PCB concentrations in Great Lakes herring gull eggs and its us in interpreting contaminants data” reports the following ratios for eggs collected at 13 study sites from the five Great Lakes. The eggs were collected from both terrestrial and aquatic feeding birds.
    
    +-------------------+-----------------------------------------------------------------------+
    |  Source Type      |   DDE to PCB Ratio                                                    |
    +-------------------+-----------------------------------------------------------------------+
    |  **Terrestrial**  | 76.50, 6.03, 3.51, 9.96, 4.24, 7.74, 9.54, 41.70, 1.84, 2.5, 1.54     |
    |  **Aquatic**      |  0.27, 0.61, 0.54, 0.14, 0.63, 0.23, 0.56,  0.48, 0.16, 0.18          |
    +-------------------+-----------------------------------------------------------------------+
    
    a) By hand, compute the mean and median separately for each type of feeder.
    b) Using your results from part (a), comment on the relative sensitivity of the mean and median to extreme values in a data set.
    c) Which measure, mean or median, would you recommend as the most appropriate measure of the DDE to PCB level for both types of feeders? Explain your answer.

2. O&L 3.31. Consumer Reports in its June 1998 issue reports on the typical daily room rate at six luxury and nine budget hotels. The room rates are given in the following table.
    
      Hotel Type   |   Nightly Rate
    ---------------|----------------------
      Luxury	     |  $175,	$180,	$120,	$150,	$120,	$125
      Budget       |  $50,	$50,	$49,	$45,	$36,	$45,	$50,	$50,	$40
    
    a) By hand, compute the means and standard deviations of the room rates for each class of hotel.
    b) Give a practical reason why luxury hotels might have higher variability than the budget hotels. (Don't just say the standard deviation is higher because there is more spread in the data, but rather think about the Hotel Industry and why you might see greater price variability for upscale goods compared to budget items.)

3. Use R to confirm your calculations in problem 1 (the pollution data). Show the code you used and the subsequent output. It will often be convenient for me to give you code that generates a data frame instead of uploading an Excel file and having you read it in. The data can be generated using the following commands:
    ```{r}
    PolutionRatios <- data.frame(
      Ratio = c(76.50, 6.03, 3.51, 9.96, 4.24, 7.74, 9.54, 41.70, 1.84, 2.5, 1.54,
                 0.27, 0.61, 0.54, 0.14, 0.63, 0.23, 0.56,  0.48, 0.16, 0.18       ),
      Type  = c( rep('Terrestrial',11), rep('Aquatic',10) ) )
    
    # Print out some of the data to confirm what the column names are
    head( PolutionRatios )
    ```
    *Hint: for computing the means and medians for each type of feeder separately, the `group_by()` command we demonstated earlier in the chapter is convenient.*

4. Use R to confirm your calculations in problem 2 (the hotel data). Show the code you used and the subsequent output. The data can be loaded into a data frame using the following commands Show the code you used and the subsequent output:
    ```{r}
    Hotels <- data.frame(
      Price = c(175, 180, 120, 150, 120, 125, 50, 50, 49, 45, 36, 45, 50, 50, 40),
      Type  = c( rep('Luxury',6),  rep('Budget', 9) ) )
    
    # Print out some of the data to confirm what the column names are
    head( Hotels )
    ```

5. For the hotel data, create side-by-side box-and-whisker plots to compare the prices.

6. Match the following histograms to the appropriate boxplot.
    ```{r, echo=FALSE}
    n <- 20000 
    m1 <- rnorm(n, mean=20, sd=2.5) 
    m2 <- rnorm(n, mean=20, sd=10) 
    m3 <- rgamma(n, shape=4, scale=15/4) 
    m4 <- c(rnorm(n/2, mean=0, sd=6), rnorm(n/2, mean=30, sd=6))
    d1 <- data.frame(obs=c(m1,m2,m3,m4), Group=rep(c('A','B','C','D'), each=n)) 
    d2 <- data.frame(obs=c(m2,m1,m4,m3), Group=rep(c('1','2','3','4'), each=n)) 
    library(ggplot2)
    p <- ggplot(d1, aes(obs)) +    
    	geom_histogram(aes(y=..density..), binwidth=1) +   
    	facet_wrap(~Group, scales='free') + xlab('Observed Value')
    print(p)
    ```
    ```{r, echo=FALSE}
    p <- qplot(Group, obs, data=d2, geom='boxplot') + 
    	xlab('') + ylab('Observed Value') 
    print(p)
    ```
    
    a) Histogram A goes with boxplot __________
    b) Histogram B goes with boxplot __________
    c) Histogram C goes with boxplot __________
    d) Histogram D goes with boxplot __________

7. Twenty-five employees of a corporation have a mean salary of $62,000 and the sample standard deviation of those salaries is $15,000. If each employee receives a bonus of $1,000, does the standard deviation of the salaries change? Explain your reasoning.



<!--chapter:end:index.Rmd-->

# Probability

```{r, echo=FALSE}
# Unattach any packages that happen to already be loaded. In general this is unecessary
# but is important for the creation of the book to not have package namespaces
# fighting unexpectedly.
pkgs = names(sessionInfo()$otherPkgs)
if( length(pkgs > 0)){
  pkgs = paste('package:', pkgs, sep = "")
  for( i in 1:length(pkgs)){
    detach(pkgs[i], character.only = TRUE, force=TRUE)
  }
}

# Set my default chunk options 
knitr::opts_chunk$set( fig.height=3 )
```

```{r, message=FALSE, warning=FALSE}
# Every chapter, we will load all the librarys we will use at the beginning
# of the chapter. 
library(ggplot2)    # graphing functions
library(dplyr)      # data summary tools
```

We need to work out the mathematics of what we mean by probability. To begin with we first define an outcome. An outcome is one observation from a random process or event. For example we might be interested in a single roll of a six-side die. Alternatively we might be interested in selecting one NAU student at random from the entire population of NAU students.

## Introduction to Set Theory

Before we jump into probability, it is useful to review a little bit of set theory.

Events are properties of a particular outcome. For a coin flip, the event “Heads” would be the event that a heads was flipped. For the single roll of a six-sided die, a possible event might be that the result is even. For the NAU student, we might be interested in the event that the student is a biology student. A second event of interest might be if the student is an undergraduate. 

1.1.1 Venn Diagrams

Let $S$ be the set of all outcomes of my random trial. Suppose I am interested in two events $A$ and $B$. The traditional way of representing these events is using a Venn diagram.

```{r, echo=FALSE}
df.A <- data.frame(theta=seq(0,2*pi, length=1000)) %>%
        mutate(x = cos(theta),
               y = sin(theta),
               grp = 'A') %>%
        select(-theta)
df.B <- df.A %>% mutate( x = x+1, grp='B')
df.box <- data.frame( x=c(-1.2,  2.2, 2.2, -1.2, -1.2),
                      y=c(-1.2, -1.2 ,1.2,  1.2, -1.2),
                      grp='Box' )
df <- rbind(df.A, df.B, df.box)
df.label <- NULL %>%
  rbind( data.frame(x= -.75, y=  .85, label='A'),
         data.frame(x= 1.75, y= -.85, label='B'),
         data.frame(x=  2.1, y=  1.1, label='S'))
ggplot(df, aes(x=x, y=y)) + 
  geom_path( aes(group=grp)) +
  scale_x_continuous(breaks=NULL) +
  scale_y_continuous(breaks=NULL) +
  geom_text( data=df.label, aes(label=label)) +
  labs(x='', y='') + theme_minimal()
```

For example, suppose that my random experiment is rolling a fair 6-sided die once. The possible outcomes are $S=\{1,2,3,4,5,6\}$. Suppose I then define events $A=$ roll is odd and $B=$ roll is 5 or greater. In this case our picture is:

```{r, echo=FALSE}
df.A <- data.frame(theta=seq(0,2*pi, length=1000)) %>%
        mutate(x = cos(theta),
               y = sin(theta),
               grp = 'A') %>%
        select(-theta)
df.B <- df.A %>% mutate( x = x+1, grp='B')
df.box <- data.frame( x=c(-1.2,  2.2, 2.2, -1.2, -1.2),
                      y=c(-1.2, -1.2 ,1.2,  1.2, -1.2),
                      grp='Box' )
df <- rbind(df.A, df.B, df.box)
df.label <- NULL %>%
  rbind( data.frame(x= -.75, y=  .85, label='A'),
         data.frame(x= 1.75, y= -.85, label='B'),
         data.frame(x=  2.1, y=  1.1, label='S'))
df.nums <- NULL %>%
  rbind( data.frame(x= -.7, y=0, label='1,3'),
         data.frame(x=  .5, y=0, label='5'),
         data.frame(x= 1.5, y=0, label='6'),
         data.frame(x=  .5, y=-1, label='2,4'))
ggplot(df, aes(x=x, y=y)) + 
  geom_path( aes(group=grp)) +
  scale_x_continuous(breaks=NULL) +
  scale_y_continuous(breaks=NULL) +
  geom_text( data=df.label, aes(label=label)) +
  geom_text( data=df.nums, aes(label=label)) +
  labs(x='', y='') + theme_minimal()
```


All of our possible events are present, and distributed amongst our possible events.

1.1.2 Composition of events

I am often interested in discussing the composition of two events and we give the common set operations below. 

* Union: Denote the event that either $A$ or $B$ occurs as $A\cup B$.
```{r, echo=FALSE}
df.A <- data.frame(theta=seq(0,2*pi, length=1000)) %>%
        mutate(x = cos(theta),
               y = sin(theta),
               grp = 'A') %>%
        select(-theta)
df.B <- df.A %>% mutate( x = x+1, grp='B')
df.box <- data.frame( x=c(-1.2,  2.2, 2.2, -1.2, -1.2),
                      y=c(-1.2, -1.2 ,1.2,  1.2, -1.2),
                      grp='Box' )
df <- rbind(df.A, df.B, df.box)
df.label <- NULL %>%
  rbind( data.frame(x= -.75, y=  .85, label='A'),
         data.frame(x= 1.75, y= -.85, label='B'),
         data.frame(x=  2.1, y=  1.1, label='S'))
ggplot(df, aes(x=x, y=y)) + 
  geom_path( aes(group=grp)) +
  geom_polygon(data=df%>%filter(grp!='Box'), 
               aes(y=y, group=grp), alpha=.4, fill='grey') +
  scale_x_continuous(breaks=NULL) +
  scale_y_continuous(breaks=NULL) +
  geom_text( data=df.label, aes(label=label)) +
  labs(x='', y='') +
  ggtitle( expression(A*union(B))) +
  theme_minimal() 
```

* Denote the event that **both** $A$ and $B$ occur as $A\cap B$
```{r, echo=FALSE}
df.A <- data.frame(theta=seq(0,2*pi, length=1000)) %>%
        mutate(x = cos(theta),
               y = sin(theta),
               grp = 'A') %>%
        select(-theta)
df.B <- df.A %>% mutate( x = x+1, grp='B')
df.Ac <- rbind(
  df.A %>% filter(x <= .5),
  df.B %>% filter(x <= .5))
df.AnB <- rbind(
  df.A %>% filter(x >= .5),
  df.B %>% filter(x <= .5))
df.Bc <- rbind(
  df.A %>% filter(x >= .5),
  df.B %>% filter(x >= .5))
df.box <- data.frame( x=c(-1.2,  2.2, 2.2, -1.2, -1.2),
                      y=c(-1.2, -1.2 ,1.2,  1.2, -1.2),
                      grp='Box' )
df <- rbind(df.A, df.B, df.box)
df.label <- NULL %>%
  rbind( data.frame(x= -.75, y=  .85, label='A'),
         data.frame(x= 1.75, y= -.85, label='B'),
         data.frame(x=  2.1, y=  1.1, label='S'))
ggplot(df, aes(x=x, y=y)) + 
  geom_path( aes(group=grp)) +
  geom_polygon(data=df.AnB, 
               aes(y=y), alpha=.4, fill='grey') +
  scale_x_continuous(breaks=NULL) +
  scale_y_continuous(breaks=NULL) +
  geom_text( data=df.label, aes(label=label)) +
  labs(x='', y='') +
  ggtitle( expression(A*intersect(B))) +
  theme_minimal() 
```


* Denote the event that $A$ does not occur as $\bar{A}$ or $A^{C}$ (different people use different notations)
```{r, echo=FALSE}
df.A <- data.frame(theta=seq(0,2*pi, length=1000)) %>%
        mutate(x = cos(theta),
               y = sin(theta),
               grp = 'A') %>%
        select(-theta)
df.B <- df.A %>% mutate( x = x+1, grp='B')
df.Ac <- rbind(
  df.A %>% filter(x <= .5),
  df.B %>% filter(x <= .5))
df.AnB <- rbind(
  df.A %>% filter(x >= .5),
  df.B %>% filter(x <= .5))
df.Bc <- rbind(
  df.A %>% filter(x >= .5),
  df.B %>% filter(x >= .5))
df.box <- data.frame( x=c(-1.2,  2.2, 2.2, -1.2, -1.2),
                      y=c(-1.2, -1.2 ,1.2,  1.2, -1.2),
                      grp='Box' )
df <- rbind(df.A, df.B, df.box)
df.label <- NULL %>%
  rbind( data.frame(x= -.75, y=  .85, label='A'),
         data.frame(x= 1.75, y= -.85, label='B'),
         data.frame(x=  2.1, y=  1.1, label='S'))
ggplot(df, aes(x=x, y=y)) + 
  geom_polygon(data=df.box, 
               aes(y=y), alpha=.4, fill='grey') +
  geom_polygon( data=df.A, fill='white') +
#  geom_polygon( data=df.B %>% filter(x <=.5), fill='grey', alpha=.4) +
  geom_path( aes(group=grp)) +
  scale_x_continuous(breaks=NULL) +
  scale_y_continuous(breaks=NULL) +
  geom_text( data=df.label, aes(label=label)) +
  labs(x='', y='') +
  ggtitle( expression( paste( bar(A), '  or  ', A^c )) ) +
  theme_minimal() 
```

**Definition 1**. Two events $A$ and $B$ are said to be mutually exclusive (or disjoint) if the occurrence of one event precludes the occurrence of the other. For example, on a single roll of a die, a two and a five cannot both come up. For a second example, define $A$ to be the event that the die is even, and $B$ to be the event that the die comes up as a $5$.

```{r, echo=FALSE}
df.A <- data.frame(theta=seq(0,2*pi, length=1000)) %>%
        mutate(x = cos(theta),
               y = sin(theta),
               grp = 'A') %>%
        select(-theta)
df.B <- df.A %>% mutate( x = x+2.5, grp='B')
df.box <- data.frame( x=c(-1.2,  3.8, 3.8, -1.2, -1.2),
                      y=c(-1.2, -1.2 ,1.2,  1.2, -1.2),
                      grp='Box' )
df <- rbind(df.A, df.B, df.box)
df.label <- NULL %>%
  rbind( data.frame(x= -.75, y=  .85, label='A'),
         data.frame(x= 1.75, y= -.85, label='B'),
         data.frame(x= 3.65, y=  1.1, label='S'))
ggplot(df, aes(x=x, y=y)) + 
  geom_path( aes(group=grp)) +
  scale_x_continuous(breaks=NULL) +
  scale_y_continuous(breaks=NULL) +
  geom_text( data=df.label, aes(label=label)) +
  labs(x='', y='') + theme_minimal()
```

## Probability Rules

### Simple Rules

We now take our Venn diagrams and use them to understand the rules of probability. The underlying idea that we will use is the the probability of an event is the area in the Venn diagram.

**Definition 2**. Probability is the proportion of times an event occurs in many repeated trials of a random phenomenon. In other words, probability is the long-term relative frequency.

**Fact**. *For any event $A$ the probability of the event $P(A)$ satisfies $0\le P(A) \le 1$ because proportions always lie in $[0,1]$.*
 
Because $S$ is the set of all events that might occur, the area of our bounding rectangle will be $1$ and the probability of event $A$ occurring will be represented by the area in the circle $A$.

**Fact**. *If two events are mutually exclusive, then $P(A\cup B)=P(A)+P(B)$*

```{r, echo=FALSE}
df.A <- data.frame(theta=seq(0,2*pi, length=1000)) %>%
        mutate(x = cos(theta),
               y = sin(theta),
               grp = 'A') %>%
        select(-theta)
df.B <- df.A %>% mutate( x = x+2.5, grp='B')
df.box <- data.frame( x=c(-1.2,  3.8, 3.8, -1.2, -1.2),
                      y=c(-1.2, -1.2 ,1.2,  1.2, -1.2),
                      grp='Box' )
df <- rbind(df.A, df.B, df.box)
df.label <- NULL %>%
  rbind( data.frame(x= -.75, y=  .85, label='A'),
         data.frame(x= 1.75, y= -.85, label='B'),
         data.frame(x= 3.65, y=  1.1, label='S'))
ggplot(df, aes(x=x, y=y)) + 
  geom_polygon(data=df.A, fill='grey', alpha=.7) +
  geom_polygon(data=df.B, fill='grey', alpha=.7) +
  geom_path( aes(group=grp)) +
  scale_x_continuous(breaks=NULL) +
  scale_y_continuous(breaks=NULL) +
  geom_text( data=df.label, aes(label=label)) +
  labs(x='', y='') + 
  ggtitle(expression( P( A*union(B) ) == P(A) + P(B)  )) +
  theme_minimal()
```
 


**Example**. Let $R$ be the sum of two different colored dice. Suppose we are interested in $P(R \le 4)$. Notice that the pair of dice can fall 36 different ways (6 ways for the first die and six for the second results in 6x6 possible outcomes, and each way has equal probability $1/36$. Because the dice cannot simultaneously sum to $2$ and to $3$, we could write P(R \le 4 )	=	P(R=2)+P(R=3)+P(R=4)
	=	P(\left\{ 1,1\right\} )+P(\left\{ 1,2\right\} \mathrm{\textrm{ or }}\left\{ 2,1\right\} )+P(\{1,3\}\textrm{ or }\{2,2\}\textrm{ or }\{3,1\})
	=	\frac{1}{36}+\frac{2}{36}+\frac{3}{36}
	=	\frac{6}{36}
	=	\frac{1}{6}
 

**Fact**. $P(A)+P(\bar{A})=1$
```{r, echo=FALSE}
df.A <- data.frame(theta=seq(0,2*pi, length=1000)) %>%
        mutate(x = cos(theta),
               y = sin(theta),
               grp = 'A') %>%
        select(-theta)
df.B <- df.A %>% mutate( x = x+2.5, grp='B')
df.box <- data.frame( x=c(-1.2,  3.8, 3.8, -1.2, -1.2),
                      y=c(-1.2, -1.2 ,1.2,  1.2, -1.2),
                      grp='Box' )
df <- rbind(df.A, df.box)
df.label <- NULL %>%
  rbind( data.frame(x= -.75, y=  .85, label='A'),
         data.frame(x= 1.75, y=    0, label='A^c'),
         data.frame(x= 3.65, y=  1.1, label='S'))
ggplot(df, aes(x=x, y=y)) + 
  geom_polygon(data=df.box, fill='pink', alpha=.7) + 
  geom_polygon(data=df.A, fill='grey', alpha=.7) +
  geom_path( aes(group=grp)) +
  scale_x_continuous(breaks=NULL) +
  scale_y_continuous(breaks=NULL) +
  geom_text( data=df.label, aes(label=label), parse=TRUE) +
  labs(x='', y='') +
  ggtitle(expression( P( A ) + P(A^c) == 1  )) +
  theme_minimal()
```  

The above statement is true because the probability of whole space $S$ is one (remember $S$ is all possible outcomes), then either we get an outcome in which $A$ occurs or we get an outcome in which $A$ does not occur.

**Fact**. $P(A\cup B)=P(A)+P(B)-P(A\cap B)$

The reason behind this fact is that if there is if $A$ and $B$ are not disjoint, then some area is added twice when I calculate $P\left(A\right)+P\left(B\right)$. To account for this, I simply subtract off the area that was double counted.

```{r, echo=FALSE}
df.A <- data.frame(theta=seq(0,2*pi, length=1000)) %>%
        mutate(x = cos(theta),
               y = sin(theta),
               grp = 'A') %>%
        select(-theta)
df.B <- df.A %>% mutate( x = x+1, grp='B')
df.Ac <- rbind(
  df.A %>% filter(x <= .5),
  df.B %>% filter(x <= .5))
df.AnB <- rbind(
  df.A %>% filter(x >= .5),
  df.B %>% filter(x <= .5))
df.Bc <- rbind(
  df.A %>% filter(x >= .5),
  df.B %>% filter(x >= .5))
df.box <- data.frame( x=c(-1.2,  2.2, 2.2, -1.2, -1.2),
                      y=c(-1.2, -1.2 ,1.2,  1.2, -1.2),
                      grp='Box' )
df <- rbind(df.A, df.B, df.box)
df.label <- NULL %>%
  rbind( data.frame(x= -.75, y=  .85, label='A'),
         data.frame(x= 1.75, y= -.85, label='B'),
         data.frame(x=  2.1, y=  1.1, label='S'))
ggplot(df, aes(x=x, y=y)) + 
  geom_path( aes(group=grp)) +
  geom_polygon(data=df.A, alpha=.4, fill='red') +
  geom_polygon(data=df.B, alpha=.4, fill='blue') +
  scale_x_continuous(breaks=NULL) +
  scale_y_continuous(breaks=NULL) +
  geom_text( data=df.label, aes(label=label)) +
  labs(x='', y='') +
  ggtitle(expression( P(A*union(B)) == P(A) + P(B) - P(A*intersect(B)) )) +
  theme_minimal() 
```



**Fact 3**. $P(A)=P(A\cap B)+P(A\cap\bar{B})$

```{r, echo=FALSE}
df.A <- data.frame(theta=seq(0,2*pi, length=1000)) %>%
        mutate(x = cos(theta),
               y = sin(theta),
               grp = 'A') %>%
        select(-theta)
df.B <- df.A %>% mutate( x = x+1, grp='B')
df.Ac <- rbind(
  df.A %>% filter(x <= .5),
  df.B %>% filter(x <= .5))
df.AnB <- rbind(
  df.A %>% filter(x >= .5),
  df.B %>% filter(x <= .5))
df.Bc <- rbind(
  df.A %>% filter(x >= .5),
  df.B %>% filter(x >= .5))
df.box <- data.frame( x=c(-1.2,  2.2, 2.2, -1.2, -1.2),
                      y=c(-1.2, -1.2 ,1.2,  1.2, -1.2),
                      grp='Box' )
df <- rbind(df.A, df.B, df.box)
df.label <- NULL %>%
  rbind( data.frame(x= -.75, y=  .85, label='A'),
         data.frame(x= 1.75, y= -.85, label='B'),
         data.frame(x=  2.1, y=  1.1, label='S'))
ggplot(df, aes(x=x, y=y)) + 
  geom_path( aes(group=grp)) +
  geom_polygon(data=df.A, alpha=.4, fill='red') +
  geom_polygon(data=df.AnB, alpha=.4, fill='blue') +
  scale_x_continuous(breaks=NULL) +
  scale_y_continuous(breaks=NULL) +
  geom_text( data=df.label, aes(label=label)) +
  labs(x='', y='') +
  ggtitle(expression( P(A) == P(A*intersect(B^c)) + P(A*intersect(B)) )) +
  theme_minimal() 
```

This identity is just breaking the event $A$ into two disjoint pieces.



### Conditional Probability

We are given the following data about insurance claims. Notice that the data is given as $P(\;Category\;\cap\;PolicyType\;)$ which is apparent because the sum of all the elements in the table is $100\%$

  $\,$               |  Fire  | Auto  |  Other
-------------------- | ------ | ----- | ---------  
 **Fraudulant**      |    6%  |  1%   |   3%
 **non-Fraudulant**  |   14%  |  29%  |   47%


Summing across the rows and columns, we can find the probabilities of for each category and policy type.

  $\,$               |  Fire    |  Auto   |  Other    |  $\,$
-------------------- | -------- | ------- | --------- | ---------- 
 **Fraudulant**      |    6%    |   1%    |   3%      |  **10%**
 **non-Fraudulant**  |   14%    |   29%   |   47%     |  **90%**
 $\,$                |  **20%** | **30%** | **50%**   |  **100%**

It is clear that fire claims are more likely fraudulent than auto or other claims. In fact, the proportion of fraudulent claims, given that the claim is against a fire policy is 
$$\begin{aligned}
P(\textrm{ Fraud }|\textrm{ FirePolicy })	&=	\frac{\textrm{proportion of claims that are fire policies and are fraudulent}}{\textrm{proportion of fire claims}} \\
	&=	\frac{6\%}{20\%}\\
	& \\
	&=	0.3
	\end{aligned}$$
 

In general we define conditional probability (assuming $P(B) \ne 0$) as 
$$P(A|B)=\frac{P(A\cap B)}{P(B)}$$
which can also be rearranged to show 
$$\begin{aligned}
P(A\cap B)	&=	P(A\,|\,B)\,P(B) \\
	          &=	P(B\,|\,A)\,P(A)
\end{aligned}$$
 Because the order doesn't matter and $P\left(A\cap B\right)=P\left(B\cap A\right)$.

Using this rule, we might calculate the probability that a claim is an Auto policy given that it is not fraudulent.
$$\begin{aligned}
P\left(\,Auto\;|\;NotFraud\,\right)	&= \frac{P\left(\,Auto\;\cap\;NotFraud\right)}{P\left(\,NotFraud\,\right)} \\
	&=	\frac{0.29}{0.9} \\
	&	\\
	&=	0.3\bar{2}
	\end{aligned}$$
 

**Definition 4**. *Two events $A$ and $B$ are said to be independent if $P(A|B)=P(A)\;\;\textrm{and}\;\;P(B|A)=P(B)$.*
 
What independence is saying that knowing the outcome of event $A$ doesn't give you any information about the outcome of event $B$. 

*In simple random sampling, we assume that any two samples are independent.
* In cluster sampling, we assume that samples within a cluster are not independent, but clusters are independent of each other.

**Fact 5**. *If $A$ and $B$ are independent events, then $P(A\cap B)	=	P(A|B)P(B) =	P(A)P(B)$.*
 

**Example 6**. Suppose that we are interested in the relationship between the color and the type of car. Specifically I will divide the car world into convertibles and non-convertibles and the colors into red and non-red.

Suppose that convertibles make up just 10% of the domestic automobile market. This is to say $P(\;Convertable\;)=0.10$. Of the non-convertibles, red is not unheard of but it isn't common either. So suppose $P(\;Red\;|\;NonConvertable\;)=0.15$. However red is an extremely popular color for convertibles so let $P(\;Red\;|\;Convertable\;)=0.60$.

Given the above information, we can create the following table:

   $\,$       |    Convertable      |  Not Convertable   |  $\,$
------------- | ------------------- | ------------------ | ----------   
 **Red**      |                     |                    |
 **Not Red**  |                     |                    |
 $\,$         |     **10%**         |     **90%**        |  **100%**

We can fill in some of the table using our the definition of conditional probability. For example:
$$\begin{aligned}
P\left(Red\,\cap\,Convertable\right)	&= P\left(Red\,|\,Convertable\right)\,P\left(Convertable\right) \\
	&=	0.60*0.10 \\
	&=	0.06
  \end{aligned}$$
 

Lets think about what this conditional probability means. Of the $90\%$ of cars that are not convertibles, $15\%$ those non-convertibles are red and therefore the proportion of cars that are red non-convertibles is $0.90*0.15=0.135$. Of the $10\%$ of cars that are convertibles, $60\%$ of those are red and therefore proportion of cars that are red convertibles is $0.10*0.60=0.06$. Thus the total percentage of red cars is actually 
$$\begin{aligned}P\left(\,Red\,\right)	
  &= P\left(\;Red\;\cap\;Convertible\;\right)+P\left(\,Red\,\cap\,NonConvertible\,\right)\\
	&= P\left(\,Red\,|\,Convertable\,\right)P\left(\,Convertible\,\right)+P\left(\,Red\,|\,NonConvertible\,\right)P\left(\,NonConvertible\,\right)\\
	&=	0.60*0.10+0.15*0.90\\
	&=	0.06+0.135\\
	&=	0.195
	\end{aligned}$$
 So when I ask for $P(\;red\;|\;convertable\;)$, I am narrowing my space of cars to consider only convertibles. While there percentage of cars that are red and convertible is just 6% of all cars, when I restrict myself to convertibles, we see that the percentage of this smaller set of cars that are red is 60%.

Notice that because $P\left(Red\right)=0.195\ne0.60=P\left(Red\,|\,Convertable\right)$ then the events $Red$ and $Convertable$ are not independent.

### Summary of Probability Rules

$$0 \le P\left(A\right) \le 1$$
		
$$P\left(A\right)+P\left(\bar{A}\right)=1$$
$$P\left(A\cup B\right)	=	P\left(A\right)+P\left(B\right)-P\left(A\cap B\right)$$
$$P\left(A\cap B\right)	=	\begin{cases}
P\left(A\,|\,B\right)P\left(B\right)\\
P\left(B\,|\,A\right)P\left(A\right)\\
P(A)P(B)\;\; & \textrm{ if A,B are independent}
\end{cases}$$
		
$$P\left(A\,|\,B\right)	=	\frac{P\left(A\cap B\right)}{P\left(B\right)}$$
 

## Discrete Random Variables

The different types of probability distributions (and therefore your analysis method) can be divided into two general classes:

1. Continuous Random Variables - the variable takes on numerical values and could, in principle, take any of an uncountable number of values. In practical terms, if fractions or decimal points in the number make sense, it is usually continuous.

2. Discrete Random Variables - the variable takes on one of small set of values (or only a countable number of outcomes). In practical terms, if fractions or decimals points don't make sense, it is usually discrete.

Examples:

1. Presence or Absence of wolves in a State?
2. Number of Speeding Tickets received?
3. Tree girth (in cm)?
4. Photosynthesis rate?

### Introduction to Discrete Random Variables

The following facts hold for discrete random variables:

1. The probability associated with every value lies between 0 and 1
2. The sum of all probabilities for all values is equal to 1
3. Probabilities for discrete RVs are additive. i.e., $P(3\textrm{ or }4)=P(3)+P(4)$
  

#### Expected Value

Example: Consider the discrete random variable $S$, the sum of two fair dice.

```{r, echo=FALSE}
data <- data.frame(x = 2:12, y = c(1:6,5:1)/36 )
ggplot(data, aes(x=x, y=y)) +
  geom_point() +
  geom_linerange(aes(ymax=y, ymin=0)) +
  ylab('Probability') + xlab('Sum') +
  ggtitle('Distribution of the sum of two dice') +
  scale_x_continuous(breaks = c(2,4,6,8,10,12)) +
  theme_bw()
```

We often want to ask 'What is expected value of this distribution?' You might think about taking a really, really large number of samples from this distribution and then taking the mean of that really really big sample. We define the expected value (often denoted by $\mu$) as a weighted average of the possible values and the weights are the proportions with which those values occur. 
$$\mu=E[S]	=	\sum_{\textrm{possible }s}\;s\cdot P\left(S=s\right)$$
In this case, we have that
$$\begin{aligned} \mu = E[S] 
&=	\sum_{s=2}^{12}s\cdot P(S=s) \\
&=	2\cdot P\left(S=2\right)+3\cdot P\left(S=3\right)+\dots+11\cdot P\left(S=11\right)+12\cdot P\left(S=12\right) \\
&=	2\left(\frac{1}{36}\right)+3\left(\frac{2}{36}\right)+\dots+11\left(\frac{2}{36}\right)+12\left(\frac{1}{36}\right) \\
&=	7
\end{aligned}$$ 

#### Variance

Similarly we could define the variance of $S$ (which we often denote $\sigma^{2}$) as a weighted average of the squared-deviations that could occur. 
$$ \sigma^{2}=V[S]	= \sum_{\textrm{possible }s}\; (s-\mu)^2 \cdot P\left(S=s\right)$$
which in this example can be calculated as
$$\begin{aligned} \sigma^{2}=V[S] 
  &= \sum_{s=2}^{12}\left(s-\mu\right)^{2}P(S=s) \\
	&= (2-7)^{2}\left(\frac{1}{36}\right)+(3-7)^{2}\left(\frac{2}{36}\right)+\dots+(12-7)^{2}\left(\frac{1}{36}\right) \\
	&= \frac{35}{6}=5.8\bar{3}
	\end{aligned}$$
	
 We could interpret the expectation as the sample mean of an infinitely large sample, and the variance as the sample variance of the same infinitely large sample. These are two very important numbers that describe the distribution.

**Example 7**. My wife is a massage therapist and over the last year, the number of clients she sees per work day (denoted Y
 ) varied according the following table:

  Number of Clients         |   0   |   1   |   2   |   3   |   4
--------------------------- | ----- | ----- | ----- | ----- | ----- 
  **Frequency/Probability** |  0.30 |  0.35 |  0.20 |  0.10 |  0.05

```{r}
distr <- data.frame(    clients = c( 0,   1,    2,    3,    4   ),    # two columns 
                    probability = c(0.3, 0.35, 0.20, 0.10, 0.05 ) )   # 

ggplot(distr, aes(x=clients)) +                   # graph with clients as the x-axis
  geom_point(aes(y=probability)) +                # where the dots go
  geom_linerange(aes(ymax=probability, ymin=0)) + # the vertical lines       
  theme_bw()                                      # set background color...
```
Because this is the long term relative frequency of the number of clients (over 200 working days!), it is appropriate to interpret these frequencies as probabilities. This table and graph is often called a probability mass function (pmf) because it lists how the probability is spread across the possible values of the random variable. We might next ask ourselves what is the average number of clients per day? It looks like it ought to be between 1 and 2 clients per day. 
$$\begin{aligned} E\left(Y\right)	
  &=	\sum_{\textrm{possible }y}y\,P\left(Y=y\right) \\
	&=	\sum_{y=0}^{4}y\,P\left(Y=y\right) \\
	&=	0\,P\left(Y=0\right)+1\,P\left(Y=1\right)+2\,P\left(Y=2\right)+3\,P\left(Y=3\right)+4\,P\left(Y=4\right) \\
	&=	0\left(0.3\right)+1\left(0.35\right)+2\left(0.20\right)+3\left(0.10\right)+4\left(0.05\right) \\
	&=	1.25 \end{aligned}$$
 
Assuming that successive days are independent (which might be a bad assumption) what is the probability she has two days in a row with no clients?
$$\begin{aligned}P\left(\textrm{0 on day1 }and\textrm{ 0 on day2}\right)	
  &=	P\left(\textrm{0 on day 1}\right)P\left(\textrm{0 on day 2}\right) \\
	&=	\left(0.3\right)\left(0.3\right) \\
	&=	0.09 \end{aligned}$$
 
What is the variance of this distribution?
$$\begin{aligned}V\left(Y\right)	
  &= \sum_{\textrm{possible y}}\,\left(y-\mu\right)^{2}\,P\left(Y=y\right) \\
	&= \sum_{y=0}^{4}\,\left(y-\mu\right)^{2}P\left(Y=y\right) \\
	&=	\left(0-1.25\right)^{2}\left(0.3\right)+\left(1-1.25\right)^{2}\left(0.35\right)+\left(2-1.25\right)^{2}\left(0.20\right)+\left(3-1.25\right)^{2}\left(0.10\right)+\left(4-1.25\right)^{2}\left(0.05\right) \\
	&=	1.2875 \end{aligned}$$
 
Note on Notation: There is a difference between the upper and lower case letters we have been using to denote a random variable. In general, we let the upper case denote the random variable and the lower case as a value that the the variable could possibly take on. So in the massage example, the number of clients seen per day $Y$ could take on values $y=0,1,2,3,$ or $4$. 

## Common Discrete Distributions

### Binomial Distribution

**Example**: Suppose we are trapping small mammals in the desert and we spread out three traps. Assume that the traps are far enough apart that having one being filled doesn't affect the probability of the others being filled and that all three traps have the same probability of being filled in an evening. Denote the event that a trap is filled with a critter as $C_{i}$ and denote the event that the trap is empty as $E_{i}$. Denote the probability that a trap is filled by \pi=0.8. (This sort of random variable is often referred to as a Bernoulli RV.)

The possible outcomes are 
  
  Outcome           |  $\,$
------------------- | ------
  $E_1, E_2, E_3$   |  $\,$
  $C_1, E_2, E_3$   |  $\,$
  $E_1, C_2, E_3$   |  $\,$
  $E_1, E_2, C_3$   |  $\,$
  $C_1, C_2, E_3$   |  $\,$
  $C_1, E_2, C_3$   |  $\,$
  $E_1, C_2, C_3$   |  $\,$
  $C_1, C_2, C_3$   |  $\,$

Because these are far apart enough in space that the outcome of Trap1 is independent of Trap2 and Trap3, then 
$$P(E_{1}\cap C_{2}\cap E_{3})	=	P(E_{1})P(C_{2})P(E_{3})
	=	(1-0.8)0.8(1-0.8)
	=	0.032$$
**Notice how important the assumption of independence is!!!** Similarly we could calculate the probabilities for the rest of the table.

  Outcome           |   Probability   |  $S$ Outcome  |   Probability
------------------- | --------------- | ------------- | ---------------
  $E_1, E_2, E_3$   |     0.008       |   $S=0$       |     0.008
------------------- | --------------- | ------------- | ---------------
  $C_1, E_2, E_3$   |     0.032       |               |
  $E_1, C_2, E_3$   |     0.032       |   $S=1$       |  $3(0.032) = 0.096$
  $E_1, E_2, C_3$   |     0.032       |               |
------------------- | --------------- | ------------- | ---------------
  $C_1, C_2, E_3$   |     0.128       |               |
  $C_1, E_2, C_3$   |     0.128       |   $S=2$       |  $3(0.128) = 0.384$
  $E_1, C_2, C_3$   |     0.128       |               |
------------------- | --------------- | ------------- | ---------------
  $C_1, C_2, C_3$   |     0.512       |   $S=3$       |  $0.512$


Next we are interested in the random variable $S$, the number of traps that were filled:

  $S$ Outcome  |   Probability
 ------------- | ---------------
   $S=0$       |  $0.008$
   $S=1$       |  $0.096$
   $S=2$       |  $0.384$
   $S=3$       |  $0.512$


$S$ is an example of a Binomial Random Variable. A binomial experiment is one that:

1. Experiment consists of $n$ identical trials.
2. Each trial results in one of two outcomes (Heads/Tails, presence/absence). One will be labeled a success and the other a failure.
3. The probability of success on a single trial is equal to $\pi$ and remains the same from trial to trial. 
4. The trials are independent (this is implied from property 3).
5. The random variable $Y$ is the number of successes observed during $n$ trials.

Recall that the probability mass function (pmf) describes how the probability is spread across the possible outcomes, and in this case, I can describe this via a nice formula. The pmf of a a binomial random variable $X$ taken from $n$ trials each with probability of success $\pi$ is 

$$P(X=x)=\underbrace{\frac{n!}{x!(n-x)!}}_{orderings}\;\underbrace{\pi^{x}}_{y\,successes}\;\underbrace{(1-\pi)^{n-x}}_{n-y\,failures}$$
 
where we define $n!=n(n-1)\dots(2)(1)$ and further define $0!=1$. Often the ordering term is written more compactly as $${n \choose x}=\frac{n!}{x!\left(n-x\right)!}$$. 

For our small mammal example we can create a graph that shows the binomial distribution with the following R code:

```{r}
dist <- data.frame( x=0:3 ) %>% 
  mutate(probability = dbinom(x, size=3, prob=0.8))
ggplot(dist, aes(x=x)) +
  geom_point(aes(y=probability)) +
  geom_linerange(aes(ymax=probability, ymin=0)) +
  ggtitle('Binomial distribution: n=3, p=0.8') +
  theme_bw()
```

To calculate the height of any of these bars, we can evaluate the pmf at the desired point. For example, to calculate the probability the number of full traps is 2, we calculate the following

$$\begin{aligned} P(X=2)	
  &=	{3 \choose 2}\left(0.8\right)^{2}\left(1-0.8\right)^{3-2} \\
	&=	\frac{3!}{2!(3-2)!}(0.8)^{2}(0.2)^{3-2} \\
	&=	\frac{3\cdot2\cdot1}{(2\cdot1)1}\;(0.8)^{2}(0.2) \\
	&=	3(0.128) \\
	&=	0.384 \end{aligned}$$
 
You can use R to calculate these probabilities. In general, for any distribution, the “d-function” gives the distribution function (pmf or pdf). So to get R to do the preceding calculation we use:

```{r}
# If    X ~ Binomial(n=3, pi=0.8)
# Then  P( X = 2 | n=3, pi=0.8 ) =
dbinom(2, size=3, prob=0.8)
```

The expectation of this distribution can be shown to be 
$$\begin{aligned}E[X]	
  &=	\sum_{x=0}^{n}x\,P(X=x) \\
	&=	\sum_{x=0}^{n}x\;\frac{n!}{x!\left(n-x\right)!}\pi^{x}\left(1-\pi\right)^{n-x}\\
	&=	\vdots \\
	&=	n\pi \end{aligned}$$
 
and the variance can be similarly calculated
$$\begin{aligned} V[X]	
  &=	\sum_{x=0}^{n}\left(x-E\left[X\right]\right)^{2}\,P\left(X=x|n,\pi\right) \\
	&=	\sum_{x=0}^{n}\left(x-E\left[X\right]\right)^{2}\;\frac{n!}{x!\left(n-x\right)!}\pi^{x}\left(1-\pi\right)^{n-x} \\
	&=	\vdots \\
	&=	n\pi(1-\pi) \end{aligned}$$
 

**Example 8**. Suppose a bird survey only captures the presence or absence of a particular bird (say the mountain chickadee). Assuming the true presence proportion at national forest sites around Flagstaff $$\pi=0.1$$, then for $n=20$ randomly chosen sites, the number of sites in which the bird was observed would have the distribution

```{r}
dist <- data.frame( x = 0:20 ) %>% 
  mutate(probability = dbinom(x, size=20, prob=0.1))
ggplot(dist, aes(x=x)) +
  geom_point(aes(y=probability)) +
  geom_linerange(aes(ymax=probability, ymin=0)) +
  ggtitle('Binomial distribution: n=20, p=0.1') +
  xlab('Number of Sites Occupied') +
  theme_bw()
```

Often we are interested in questions such as $P(X\le2)$ which is the probability that we see 2 or fewer of the sites being occupied by mountain chickadee. These calculations can be tedious to calculate by hand but R will calculate these cumulative distribution function values for you using the “p-function”. This cumulative distribution function gives the sum of all values up to and including the number given.

```{r}
# P(X=0) + P(X=1) + P(X=2)
sum <- dbinom(0, size=20, prob=0.1) + 
       dbinom(1, size=20, prob=0.1) + 
       dbinom(2, size=20, prob=0.1)
sum
# P(X <= 2)
pbinom(2, size=20, prob=0.1)
```

In general we will be interested in asking four different questions about a distribution.

1. What is the height of the probability mass function (or probability density function). For discrete variable $Y$ this is $P\left(Y=y\right)$ for whatever value of $y$ we want. In R, this will be the `d`-function.
2. What is the probability of observing a value less than or equal to $y$? In other words, to calculate $P\left(Y\le y\right)$. In R, this will be the `p`-function.
3. What is a particular quantile of a distribution? For example, what value separates the lower $25\%$ from the upper $75\%$? In R, this will be the `q`-function.
4. Generate a random sample of values from a specified distribution. In R, this will be the `r`-function.

### Poisson Distribution

A commonly used distribution for count data is the Poisson.

1. Number of customers arriving over a 5 minute interval
2. Number of birds observed during a 10 minute listening period
3. Number of prairie dog towns per 1000 hectares
4. Number of alga clumps per cubic meter of lake water

For a RV is a Poisson RV if the following conditions apply:

1. Two or more events do not occur at precisely the same time or in the same space
2. The occurrence of an event in a given period of time or region of space is independent of the occurrence of the event in a non overlapping period or region.
3. The expected number of events during one period or region, $\lambda$, is the same in all periods or regions of the same size.

Assuming that these conditions hold for some count variable $Y$, the the probability mass function is given by
$$P(Y=y)=\frac{\lambda^{y}e^{-\lambda}}{y!}$$
where $\lambda$ is the expected number of events over 1 unit of time or space and $e$ is the constant $2.718281828\dots$. 

$$E[Y]	=	\lambda$$
$$Var[Y]	=	\lambda$$
 

**Example 9**. Suppose we are interested in the population size of small mammals in a region. Let $Y$ be the number of small mammals caught in a large trap (multiple traps in the same location?) in a 12 hour period. Finally, suppose that $Y\sim Poi(\lambda=2.3)$. What is the probability of finding exactly 4 critters in our trap?
$$P(Y=4)	=	\frac{2.3^{4}\,e^{-2.3}}{4!} =	0.1169$$
 What about the probability of finding at most 4?
 $$\begin{aligned} P(Y\le4)	
  &=	P(Y=0)+P(Y=1)+P(Y=2)+P(Y=3)+P(Y=4) \\
	&=	0.1003+0.2306+0.2652+0.2033+0.1169 \\
	&=	0.9163 \end{aligned}$$
 
What about the probability of finding 5 or more?
$$P(Y\ge5)	=	1-P(Y\le4) =	1-0.9163 =	0.0837$$

These calculations can be done using the distribution function (d-function) for the poisson and the cumulative distribution function (p-function).

```{r}
dist <- data.frame( NumCaught = 0:10 ) %>%
  mutate( probability = dpois( NumCaught, lambda=2.3 ) )
ggplot(dist, aes(x=NumCaught)) +
  geom_point( aes(y=probability) ) +
  geom_linerange(aes( ymax=probability, ymin=0)) +
  ggtitle(expression(paste('Poisson Distribution with  ', lambda == 2.3))) +
  labs(x='Number Caught') +
  theme_bw()            

# P( Y = 4)
dpois(4, lambda=2.3)
# P( Y <= 4)
ppois(4, lambda=2.3)
# 1-P(Y <= 4)  ==  P( Y > 4)  ==  P( Y >= 5)
1-ppois(4, 2.3)
```

## Continuous Random Variables

Continuous random variables can take on an (uncountably) infinite number of values, and this results in a few obnoxious mathematical differences between how we handle continuous and discrete random variables.  In particular, the probability that a continuous random variable $X$ will take on a particular value will be zero, so we will be interested in finding the probability that the random variable is in some interval instead.  Wherever we had a summation, $\sum$, we will instead have an integral, but because many students haven't had calculus, we will resort to using R or tables of calculated values.

### Uniform(0,1) Distribution

Suppose you wish to draw a random number number between 0 and 1 and any two intervals of equal size should have the same probability of the value being in them. This random variable is said to have a Uniform(0,1) distribution.

Because there are an infinite number of rational numbers between 0 and 1, the probability of any particular number being selected is $1/\infty=0$. But even though each number has 0 probability of being selected, some number must end up being selected. Because of this conundrum, probability theory doesn't look at the probability of a single number, but rather focuses on a region of numbers. 

To make this distinction, we will define the distribution using a probability density function (pdf) instead of the probability mass function. In the discrete case, we had to constrain the probability mass function to sum to 1. In the continuous case, we have to constrain the probability density function to integrate to 1.

```{r, echo=FALSE}
data <- data.frame(x = seq(-.2, 1.2, length=1000)) %>%
  mutate( y = dunif(x))
ggplot(data, aes(x=x, y=y)) +
  geom_line() +
  labs(x='X', y='density', title='PDF of Uniform(0,1)') +
  geom_text(x=.5, y=.5, label='Area = 1') +
  theme_bw() 
```

```{r, echo=FALSE}
data <- data.frame(x = seq(-.2, 1.2, length=1000)) %>%
  mutate( y = dunif(x))
ggplot(data, aes(x=x, y=y)) +
  geom_line() +
  geom_area(data=data %>% filter(x < .4), fill='grey', alpha=.4) +
  labs(x='X', y='density', title='PDF of Uniform(0,1)') +
  geom_text(x=.2, y=.5, label='P(X<=0.4) == 0.4', parse=TRUE) +
  theme_bw() 
```

Finding the area under the curve of a particular density function $f(x)$ usually requires the use of calculus, but since this isn't a calculus course, we will resort to using R or tables of calculated values.

### Exponential Distribution

The exponential distribution is the continuous analog of the Poisson distribution and is often used to model the time between occurrence of successive events. Perhaps we are modeling time between transmissions on a network, or the time between feeding events or prey capture. If the random variable $X$ has an Exponential distribution, its probability density function is 
$$f(x)=\begin{cases}
\lambda e^{-\lambda x} & x\ge0\;\textrm{ and }\;\lambda>0\\
0 & \textrm{otherwise}
\end{cases}$$
 



Analogous to the discrete distributions, we can define the Expectation and Variance of these distributions by replacing the summation with an integral
$$\mu = E[X] =	\int_{0}^{\infty}x\,f(x)\,dx = \dots = \frac{1}{\lambda} $$
$$\sigma^2 = Var[X]	=	\int_{0}^{\infty}\left(x-\mu\right)^{2}\,f\left(x\right)\,dx =	\dots = \frac{1}{\lambda^{2}}$$
 
Because the exponential distribution is defined by the rate of occurrence of an event, increasing that rate decreases the time between events. Furthermore because the rate of occurrence cannot be negative, we restrict $\lambda>0$.

```{r, echo=FALSE}
data <- expand.grid(x=seq(0,10,length=1000), lambda = c(.5, 1, 2)) %>%
  mutate(y=dexp(x, rate = lambda),
         lambda = paste('lambda == ', lambda))
ggplot(data, aes(x=x, y=y)) +
  geom_area(fill='grey') +
  facet_grid(lambda~., labeller = labeller(lambda=label_parsed)) +
  labs(y='density') +
  theme_bw()
```

**Example 10**. Suppose the time between insect captures $X$ during a summer evening for a species of bat follows a exponential distribution with capture rate of $\lambda=2$ insects per minute and therefore the expected waiting time between captures is $1/\lambda=1/2$ minute. Suppose that we are interested in the probability that it takes a bat more than 1 minute to capture its next insect.

$$P(X>1)=$$
 
```{r}
data <- data.frame(x=seq(0,5,length=1000), lambda = 2) %>%
  mutate(y=dexp(x, rate = lambda),
         grp = ifelse( x > 1, '> 1', '<= 1'))
ggplot(data, aes(x=x, y=y, fill=grp)) +
  geom_area() +
  labs(y='density') +
  theme_bw()
```

We now must resort to calculus to find this area. Or use tables of pre-calculated values. Or use R, remembering that p-functions give the area under the curve to the left of the given value.

```{r}
# P(X > 1)  == 1 - P(X <= 1)
1 - pexp(1, rate=2)
```

### Normal Distribution

Undoubtably the most important distribution in statistics is the normal distribution. If my RV $X$ is normally distributed with mean $\mu$ and standard deviation $\sigma$, its probability density function is given by
$$f(x)=\frac{1}{\sqrt{2\pi}\sigma}\exp\left[\frac{-(x-\mu)^{2}}{2\sigma^{2}}\right]$$
 where $\exp[y]$ is the exponential function $e^{y}$. We could slightly rearrange the function to

$$f(x)=\frac{1}{\sqrt{2\pi}\sigma}\exp\left[-\frac{1}{2}\left(\frac{x-\mu}{\sigma}\right)^{2}\right]$$
 

and see this distribution is defined by its expectation $E[X]=\mu$ and its variance $Var[X]=\sigma^{2}$. Notice I could define it using the standard deviation $\sigma$, and different software packages will expect it to be defined by one or the other. R defines the normal distribution using the standard deviation. 

```{r, echo=FALSE}
data <- rbind(data.frame(x=seq(-5,8,length=2000), grp=1, mu=0, sigma=1),
              data.frame(x=seq(-5,8,length=2000), grp=2, mu=2, sigma=2),
              data.frame(x=seq(-5,8,length=2000), grp=3, mu=-3, sigma=0.6)) %>%
  mutate(y=dnorm(x, mean=mu, sd=sigma),
         mu = paste('mu == ', mu),
         sigma = paste('sigma ==', sigma))
label.df <- data.frame( grp=rep(1:3, each=2), label=c('mu == 0','sigma == 1', 'mu == 2','sigma == 2', 'mu==-3','sigma == 0.6'),
                        x = c(0,0, 4.8,4.8, -4.15,-4.15), y= c(.45,.43,  .15,.13, .55,.53))
ggplot(data, aes(x=x, y=y, color=factor(grp))) +
  geom_line() +
  geom_text(data=label.df, aes(label=label), parse=TRUE) +
  labs(y='density') +
  theme_bw() +
  scale_color_discrete(guide=FALSE)
```


**Example 11**. It is known that the heights of adult males in the US is approximately normal with a mean of 5 feet 10 inches ($\mu=70$ inches) and a standard deviation of $\sigma=3$ inches. Your instructor is a mere 5 feet 4 inches (64 inches). What proportion of the population is shorter than your professor?

```{r}
distr <- data.frame(x=seq(57, 82, length=1000)) %>%
  mutate( density = dnorm(x, mean=70, sd=3),
          group = ifelse(x<=64, 'Shorter','Taller') )
ggplot(distr, aes(x=x, y=density, fill=group)) +
  geom_line() +
  geom_area() +
  theme_bw()
```

Using R you can easily find this

```{r}
pnorm(64, mean=70, sd=3)
```

### Standardizing

Before we had computers that could calculate these probabilities for any normal distribution, it was important to know how to convert a probability statement from an arbitrary $N\left(\mu,\sigma^{2}\right)$ distribution to a question about a Stanard Normal distribution, which is a normal distribution with mean $\mu=0$ and standard deviation $\sigma=1$. If we have 
$$X\sim N\left(\mu,\sigma^{2}\right)$$
then
$$Z=\frac{X-\mu}{\sigma}\sim N\left(0,1\right)$$
 

You might remember doing something similar in an undergraduate statistics course in order to use a table to look up some probability. From the height example, we calculate
$$\begin{aligned}z	
  &=	\frac{64-70}{3} \\
	&=	\frac{-6}{3} \\
	&=	-2 \end{aligned}$$
Note that this calculation shows that he is $-2$ standard deviations from the mean. Next we look at a table for $z=-2.00$. To do this we go down to the $-2.0$ row and over to the $.00$ column and find $0.0228$. Only slightly over 2% of the adult male population is shorter!

How tall must a person be to be taller than $80\%$ of the rest of the adult male population? To answer that we must use the table in reverse and look for the $0.8$ value. We find the closest value possible $(0.7995)$ and the $z$ value associated with it is $z=0.84$. Next we solve the standardizing equation for $x$
$$\begin{aligned}
z	    &=	\frac{x-\mu}{\sigma} \\
0.84	&=	\frac{x-70}{3} \\
x	    &=	3(0.84)+70 \\
	    &=	72.49\;\textrm{inches} \end{aligned}$$

Alternatively we could use the quantile function for the normal distribution (q-function) in R and avoid the imprecision of using a table.
```{r}
qnorm(.8, mean=0, sd=1)
```


**Empirical Rule** - It is from the normal distribution that the empirical rule from the previous chapter is derived. If $X\sim N(\mu,\sigma^{2})$ then 
$$\begin{aligned} P(\mu-\sigma\le X\le\mu+\sigma)	
  &=	P(-1 \le Z \le 1) \\
	&=	P(Z \le 1) - P(Z \le -1) \\
	&\approx	0.8413-0.1587 \\
	&=	0.6826 \end{aligned}$$
 

```{r, echo=FALSE}
data <- data.frame(x=seq(-3.5,3.5,by=.1)) %>%
  mutate(y=dnorm(x))
data <- rbind( data %>% mutate(sd=1),
               data %>% mutate(sd=2),
               data %>% mutate(sd=3)) %>%
  mutate(CI = ifelse( -sd <= x & x <= sd, 'In', 'Out'),
         label = ifelse( sd == 1, '68%', ifelse(sd == 2, '95%', '99.7%')),
         sd = paste('mu %+-%', sd, '* sigma'))
ggplot(data, aes(x=x,y=y)) + 
  geom_line() +
  facet_grid(sd ~ ., labeller=label_parsed) + 
  geom_area(data=data %>% filter(CI=='In'), fill='grey') +
  geom_text(x=0, y=.2, aes(label=label)) +
  scale_x_continuous(breaks=-3:3, labels=parse(text=paste(-3:3, '*sigma')) ) +
  labs(x='', y='density') +
  theme_bw()
```

1.6 R Comments

There will be a variety of distributions we'll be interested in and R refers to them using the following abbreviations

+--------------+-------------+---------------+------------------------------------+
| Distribution |  Stem       | Parameters    | Parameter Interpretation           |
+==============+=============+===============+====================================+
| Binomial     | `binom`     | `size`        | Number of Trials                   |
|              |             | `prob`        | Probability of Success (per Trial) |
+--------------+-------------+---------------+------------------------------------+
| Exponential  | `exp`       | `rate`        | Mean of the distribution           |
+--------------+-------------+---------------+------------------------------------+
| Normal       | `norm`      | `mean=0`      | Center of the distribution         |
|              |             | `sd=1`        | Standard deviation                 |
+--------------+-------------+---------------+------------------------------------+
| Uniform      | `unif`      | `min=0`       | Minimum of the distribution        |
|              |             | `max=1`       | Maximum of the distribution        | 
+--------------+-------------+---------------+------------------------------------+


All the probability distributions available in R are accessed in exactly the same way, using a d-function, p-function, q-function, and r-function. 

+--------------------+-----------------------------------------------------------+
| Function           |    Result                                                 |
+====================+===========================================================+
| `d`-function(x)    | The height of the probability distribution/density at $x$ |
+--------------------+-----------------------------------------------------------+
| `p`-function(x)    |  $P\left(X\le x\right)$                                   |
+--------------------+-----------------------------------------------------------+
| `q`-function(q)    |  $x$ such that $P\left(X\le x\right) = q$                 |
+--------------------+-----------------------------------------------------------+
| `r`-function(n)    | $n$ random observations from the distribution             |
+--------------------+-----------------------------------------------------------+

1.7 Exercises

1. The population distribution of blood donors in the United States based on race/ethnicity and blood type as reported by the American Red Cross is given here:

    +------------+--------+---------+--------+--------+--------+
    |  $\,$      |   O    |    A    |   B    |   AB   |  Total |
    +============+========+=========+========+========+========+
    | **White**  |  36%   |  32.2%  |  8.8%  |  3.2%  |  $\,$  |
    +------------+--------+---------+--------+--------+--------+ 
    | **Black**  |   7%   |   2.9%  |  2.5%  |  0.5%  |  $\,$  |
    +------------+--------+---------+--------+--------+--------+ 
    | **Asian**  |  1.7%  |   1.2%  |   1%   |  0.3%  |  $\,$  |
    +------------+--------+---------+--------+--------+--------+ 
    | **Other**  |  1.5%  |  0.8%   |  0.3%  |  0.1%  |  $\,$  |
    +------------+--------+---------+--------+--------+--------+ 
    |  $\,$      |  $\,$  |  $\,$   |  $\,$  |  $\,$  |  100%  |
    +------------+--------+---------+--------+--------+--------+ 

    Notice that the numbers given in the table sum to 100%, so the data presented are the probability of a particular ethnicity and blood type.
    a) Fill in the column and row totals. 
    b) What is the probability that a randomly selected donor will be Asian and have Type O blood? That is to say, given a donor is randomly selected from the list of all donors, what is the probability that the selected donor will Asian with Type O?
    c) What is the probability that a randomly selected donor is white? That is to say, given a donor is randomly selected from the list of all donors, what is the probability that the selected donor is white?
    d) What is the probability that a randomly selected donor has Type A blood? That is to say, given a donor is selected from the list of all donors, what is the probability that the selected donor has Type A blood?
    e) What is the probability that a white donor will have Type A blood? That is to say, given a donor is randomly selected from the list of all the white donors, what is the probability that the selected donor has Type A blood? (Notice we already know the donor is white because we restricted ourselves to that subset!)
    f) Is blood type and ethnicity independent? Justify your response mathematically using your responses from the previous answers.

2. For each of the following, mark if it is Continuous or Discrete. 
    a) $\underline{\hspace{1in}}$ Milliliters of tea drunk per day. 
    b) $\underline{\hspace{1in}}$ Different brands of soda drunk over the course of a year. 
    c) $\underline{\hspace{1in}}$ Number of days per week that you are on-campus for any amount of time. 
    d) $\underline{\hspace{1in}}$ Number of grizzly bears individuals genetically identified from a grid of hair traps in Glacier National Park. 

3. For each scenario, state whether the event should be modeled via a binomial or Poisson distribution.
    a) $\underline{\hspace{1in}}$ Number of M&Ms I eat per hour while grading homework
    b) $\underline{\hspace{1in}}$ The number of mornings in the coming 7 days that I change my son's first diaper of the day. 
    c) $\underline{\hspace{1in}}$ The number of Manzanita bushes per 100 meters of trail. 

4. During a road bike race, there is always a chance a crash will occur. Suppose the probability that at least one crash will occur in any race I'm in is $\pi=0.2$ and that races are independent.
    a) What is the probability that the next two races I'm in will both have crashes?
    b) What is the probability that neither of my next two races will have a crash?
    c) What is the probability that at least one of the next two races have a crash?

5. My cats suffer from gastric distress due to eating house plants and the number of vomits per week that I have to clean up follows a Poisson distribution with rate $\lambda=1.2$ pukes per week. 
    a) What is the probability that I don't have to clean up any vomits this coming week?
    b) What is the probability that I must clean up 1 or more vomits?
    c) If I wanted to measure this process with a rate per day, what rate should I use?

6. Suppose that the number of runners I see on a morning walk on the trails near my house has the following distribution (Notice I've never seen four or more runners on a morning walk):
    
       y         |    0    |   1    |    2   |   3   |   4+
---------------- | ------- | ------ | ------ | ----- | ------
 **Probabilty**  |   0.45  |  0.25  |  0.20  |       |   0.0
    
    a) What is the probability that I see 3 runners on a morning walk?
    b) What is the expected number of runners that I will encounter?
    c) What is the variance of the number of runners that I will encounter?

7. If $Z\sim N\left(\mu=0,\sigma^{2}=1\right)$, find the following probabilities: 
    a) $P(Z<1.58)=$
    b) $P(Z=1.58)=$
    c) $P(Z>-.27)=$
    d) $P(-1.97<Z<2.46)=$
  
8. Using the Standard Normal Table or the table functions in R, find $z$ that makes the following statements true. 
    a) $P(Z<z)=.75$
    b) $P(Z>z)=.4$
  
9. The amount of dry kibble that I feed my cats each morning can be well approximated by a normal distribution with mean $\mu=200$ grams and standard deviation $\sigma=30$ grams.
    a) What is the probability that I fed my cats more than 250 grams of kibble this morning?
    b) From my cats' perspective, more food is better. How much would I have to feed them for this morning to be among the top $10\%$ of feedings?

<!--chapter:end:Probability.Rmd-->

